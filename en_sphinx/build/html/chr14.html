<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Chapter 14 Sequence motif analysis using Bio.motifs &mdash; biopython_en 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="biopython_en 0.1 documentation" href="index.html" />
    <link rel="next" title="Chapter 15 Cluster analysis" href="chr15.html" />
    <link rel="prev" title="Chapter 13 Phylogenetics with Bio.Phylo" href="chr13.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="chr15.html" title="Chapter 15 Cluster analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="chr13.html" title="Chapter 13 Phylogenetics with Bio.Phylo"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">biopython_en 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="chapter-14-sequence-motif-analysis-using-bio-motifs">
<h1>Chapter 14  Sequence motif analysis using Bio.motifs<a class="headerlink" href="#chapter-14-sequence-motif-analysis-using-bio-motifs" title="Permalink to this headline">¶</a></h1>
<p>This chapter gives an overview of the functionality of the
<tt class="docutils literal"><span class="pre">Bio.motifs</span></tt> package included in Biopython. It is intended for people
who are involved in the analysis of sequence motifs, so I’ll assume that
you are familiar with basic notions of motif analysis. In case something
is unclear, please look at Section <a class="reference external" href="#sec:links">14.8</a> for some
relevant links.</p>
<p>Most of this chapter describes the new <tt class="docutils literal"><span class="pre">Bio.motifs</span></tt> package included
in Biopython 1.61 onwards, which is replacing the older <tt class="docutils literal"><span class="pre">Bio.Motif</span></tt>
package introduced with Biopython 1.50, which was in turn based on two
older former Biopython modules, <tt class="docutils literal"><span class="pre">Bio.AlignAce</span></tt> and <tt class="docutils literal"><span class="pre">Bio.MEME</span></tt>. It
provides most of their functionality with a unified motif object
implementation.</p>
<p>Speaking of other libraries, if you are reading this you might be
interested in <a class="reference external" href="http://fraenkel.mit.edu/TAMO/">TAMO</a>, another python
library designed to deal with sequence motifs. It supports more
<em>de-novo</em> motif finders, but it is not a part of Biopython and has some
restrictions on commercial use.</p>
<div class="section" id="motif-objects">
<h2>14.1  Motif objects<a class="headerlink" href="#motif-objects" title="Permalink to this headline">¶</a></h2>
<p>Since we are interested in motif analysis, we need to take a look at
<tt class="docutils literal"><span class="pre">Motif</span></tt> objects in the first place. For that we need to import the
Bio.motifs library:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">motifs</span>
</pre></div>
</div>
<p>and we can start creating our first motif objects. We can either create
a <tt class="docutils literal"><span class="pre">Motif</span></tt> object from a list of instances of the motif, or we can
obtain a <tt class="docutils literal"><span class="pre">Motif</span></tt> object by parsing a file from a motif database or
motif finding software.</p>
<div class="section" id="creating-a-motif-from-instances">
<h3>14.1.1  Creating a motif from instances<a class="headerlink" href="#creating-a-motif-from-instances" title="Permalink to this headline">¶</a></h3>
<p>Suppose we have these instances of a DNA motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="kn">import</span> <span class="n">Seq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instances</span> <span class="o">=</span> <span class="p">[</span><span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TACAA&quot;</span><span class="p">),</span>
<span class="gp">... </span>             <span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TACGC&quot;</span><span class="p">),</span>
<span class="gp">... </span>             <span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TACAC&quot;</span><span class="p">),</span>
<span class="gp">... </span>             <span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TACCC&quot;</span><span class="p">),</span>
<span class="gp">... </span>             <span class="n">Seq</span><span class="p">(</span><span class="s">&quot;AACCC&quot;</span><span class="p">),</span>
<span class="gp">... </span>             <span class="n">Seq</span><span class="p">(</span><span class="s">&quot;AATGC&quot;</span><span class="p">),</span>
<span class="gp">... </span>             <span class="n">Seq</span><span class="p">(</span><span class="s">&quot;AATGC&quot;</span><span class="p">),</span>
<span class="gp">... </span>            <span class="p">]</span>
</pre></div>
</div>
<p>then we can create a Motif object as follows:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
</pre></div>
</div>
<p>The instances are saved in an attribute <tt class="docutils literal"><span class="pre">m.instances</span></tt>, which is
essentially a Python list with some added functionality, as described
below. Printing out the Motif object shows the instances from which it
was constructed:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span>
<span class="go">TACAA</span>
<span class="go">TACGC</span>
<span class="go">TACAC</span>
<span class="go">TACCC</span>
<span class="go">AACCC</span>
<span class="go">AATGC</span>
<span class="go">AATGC</span>
</pre></div>
</div>
<p>The length of the motif defined as the sequence length, which should be
the same for all instances:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>The Motif object has an attribute <tt class="docutils literal"><span class="pre">.counts</span></tt> containing the counts of
each nucleotide at each position. Printing this counts matrix shows it
in an easily readable format:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">counts</span>
<span class="go">        0      1      2      3      4</span>
<span class="go">A:   3.00   7.00   0.00   2.00   1.00</span>
<span class="go">C:   0.00   0.00   5.00   2.00   6.00</span>
<span class="go">G:   0.00   0.00   0.00   3.00   0.00</span>
<span class="go">T:   4.00   0.00   2.00   0.00   0.00</span>
</pre></div>
</div>
<p>You can access these counts as a dictionary:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">]</span>
<span class="go">[3, 7, 0, 2, 1]</span>
</pre></div>
</div>
<p>but you can also think of it as a 2D array with the nucleotide as the
first dimension and the position as the second dimension:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="s">&#39;T&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="s">&#39;T&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="s">&#39;T&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="go">0</span>
</pre></div>
</div>
<p>You can also directly access columns of the counts matrix</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">counts</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
<span class="go">{&#39;A&#39;: 2, &#39;C&#39;: 2, &#39;T&#39;: 0, &#39;G&#39;: 3}</span>
</pre></div>
</div>
<p>Instead of the nucleotide itself, you can also use the index of the
nucleotide in the sorted letters in the alphabet of the motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">alphabet</span>
<span class="go">IUPACUnambiguousDNA()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">alphabet</span><span class="o">.</span><span class="n">letters</span>
<span class="go">&#39;GATC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">alphabet</span><span class="o">.</span><span class="n">letters</span><span class="p">)</span>
<span class="go">[&#39;A&#39;, &#39;C&#39;, &#39;G&#39;, &#39;T&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,:]</span>
<span class="go">(3, 7, 0, 2, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="go">(3, 7, 0, 2, 1)</span>
</pre></div>
</div>
<p>The motif has an associated consensus sequence, defined as the sequence
of letters along the positions of the motif for which the largest value
in the corresponding columns of the <tt class="docutils literal"><span class="pre">.counts</span></tt> matrix is obtained:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">Seq(&#39;TACGC&#39;, IUPACUnambiguousDNA())</span>
</pre></div>
</div>
<p>as well as an anticonsensus sequence, corresponding to the smallest
values in the columns of the <tt class="docutils literal"><span class="pre">.counts</span></tt> matrix:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">anticonsensus</span>
<span class="go">Seq(&#39;GGGTG&#39;, IUPACUnambiguousDNA())</span>
</pre></div>
</div>
<p>You can also ask for a degenerate consensus sequence, in which ambiguous
nucleotides are used for positions where there are multiple nucleotides
with high counts:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">degenerate_consensus</span>
<span class="go">Seq(&#39;WACVC&#39;, IUPACAmbiguousDNA())</span>
</pre></div>
</div>
<p>Here, W and R follow the IUPAC nucleotide ambiguity codes: W is either A
or T, and V is A, C, or G [<a class="reference external" href="#cornish1985">10</a>]. The degenerate
consensus sequence is constructed following the rules specified by
Cavener [<a class="reference external" href="#cavener1987">11</a>].</p>
<p>We can also get the reverse complement of a motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">Seq(&#39;GCGTA&#39;, IUPACUnambiguousDNA())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">degenerate_consensus</span>
<span class="go">Seq(&#39;GBGTW&#39;, IUPACAmbiguousDNA())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">r</span>
<span class="go">TTGTA</span>
<span class="go">GCGTA</span>
<span class="go">GTGTA</span>
<span class="go">GGGTA</span>
<span class="go">GGGTT</span>
<span class="go">GCATT</span>
<span class="go">GCATT</span>
</pre></div>
</div>
<p>The reverse complement and the degenerate consensus sequence are only
defined for DNA motifs.</p>
</div>
<div class="section" id="reading-motifs">
<h3>14.1.2  Reading motifs<a class="headerlink" href="#reading-motifs" title="Permalink to this headline">¶</a></h3>
<p>Creating motifs from instances by hand is a bit boring, so it’s useful
to have some I/O functions for reading and writing motifs. There are no
really well established standards for storing motifs, but there’s a
couple of formats which are more used than others. The most important
distinction is whether the motif representation is based on instances or
on some version of PWM matrix.</p>
<div class="section" id="jaspar">
<h4>JASPAR<a class="headerlink" href="#jaspar" title="Permalink to this headline">¶</a></h4>
<p>One of the most popular motif databases
<a class="reference external" href="http://jaspar.genereg.net">JASPAR</a> stores motifs either as a list of
instances, or as a frequency matrix. As an example, these are the
beginning and ending lines of the JASPAR <tt class="docutils literal"><span class="pre">Arnt.sites</span></tt> file showing
known binding sites of the mouse helix-loop-helix transcription factor
Arnt:</p>
<div class="code python highlight-python"><pre>&gt;MA0004 ARNT    1
CACGTGatgtcctc
&gt;MA0004 ARNT    2
CACGTGggaggtac
&gt;MA0004 ARNT    3
CACGTGccgcgcgc
...
&gt;MA0004 ARNT    18
AACGTGacagccctcc
&gt;MA0004 ARNT    19
AACGTGcacatcgtcc
&gt;MA0004 ARNT    20
aggaatCGCGTGc</pre>
</div>
<p>The parts of the sequence in capital letters are the motif instances
that were found to align to each other.</p>
<p>We can create a <tt class="docutils literal"><span class="pre">Motif</span></tt> object from these instances as follows:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">motifs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arnt</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;Arnt.sites&quot;</span><span class="p">),</span> <span class="s">&quot;sites&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The instances from which this motif was created is stored in the
<tt class="docutils literal"><span class="pre">.instances</span></tt> property:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">arnt</span><span class="o">.</span><span class="n">instances</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[Seq(&#39;CACGTG&#39;, IUPACUnambiguousDNA()), Seq(&#39;CACGTG&#39;, IUPACUnambiguousDNA()), Seq(&#39;CACGTG&#39;, IUPACUnambiguousDNA())]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">arnt</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">instance</span>
<span class="gp">...</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">CACGTG</span>
<span class="go">AACGTG</span>
<span class="go">AACGTG</span>
<span class="go">AACGTG</span>
<span class="go">AACGTG</span>
<span class="go">CGCGTG</span>
</pre></div>
</div>
<p>The counts matrix of this motif is automatically calculated from the
instances:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">arnt</span><span class="o">.</span><span class="n">counts</span>
<span class="go">        0      1      2      3      4      5</span>
<span class="go">A:   4.00  19.00   0.00   0.00   0.00   0.00</span>
<span class="go">C:  16.00   0.00  20.00   0.00   0.00   0.00</span>
<span class="go">G:   0.00   1.00   0.00  20.00   0.00  20.00</span>
<span class="go">T:   0.00   0.00   0.00   0.00  20.00   0.00</span>
</pre></div>
</div>
<p>The JASPAR database also makes motifs available directly as a count
matrix, without the instances from which it was created. For example,
this is the JASPAR file <tt class="docutils literal"><span class="pre">SRF.pfm</span></tt> containing the count matrix for the
human SRF transcription factor:</p>
<div class="code python highlight-python"><pre> 2  9  0  1 32  3 46  1 43 15  2  2
 1 33 45 45  1  1  0  0  0  1  0  1
39  2  1  0  0  0  0  0  0  0 44 43
 4  2  0  0 13 42  0 45  3 30  0  0</pre>
</div>
<p>We can create a motif for this count matrix as follows:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">srf</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;SRF.pfm&quot;</span><span class="p">),</span><span class="s">&quot;pfm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">srf</span><span class="o">.</span><span class="n">counts</span>
<span class="go">        0      1      2      3      4      5      6      7      8      9     10     11</span>
<span class="go">A:   2.00   9.00   0.00   1.00  32.00   3.00  46.00   1.00  43.00  15.00   2.00   2.00</span>
<span class="go">C:   1.00  33.00  45.00  45.00   1.00   1.00   0.00   0.00   0.00   1.00   0.00   1.00</span>
<span class="go">G:  39.00   2.00   1.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00  44.00  43.00</span>
<span class="go">T:   4.00   2.00   0.00   0.00  13.00  42.00   0.00  45.00   3.00  30.00   0.00   0.00</span>
</pre></div>
</div>
<p>As this motif was created from the counts matrix directly, it has no
instances associated with it:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">srf</span><span class="o">.</span><span class="n">instances</span>
<span class="go">None</span>
</pre></div>
</div>
<p>We can now ask for the consensus sequence of these two motifs:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">arnt</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">CACGTG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">srf</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">GCCCATATATGG</span>
</pre></div>
</div>
</div>
<div class="section" id="meme">
<h4>MEME<a class="headerlink" href="#meme" title="Permalink to this headline">¶</a></h4>
<p>MEME [<a class="reference external" href="#bailey1994">12</a>] is a tool for discovering motifs in a
group of related DNA or protein sequences. It takes as input a group of
DNA or protein sequences and outputs as many motifs as requested.
Therefore, in contrast to JASPAR files, MEME output files typically
contain multiple motifs. This is an example.</p>
<p>At the top of an output file generated by MEME shows some background
information about the MEME and the version of MEME used:</p>
<div class="code python highlight-python"><pre>********************************************************************************
MEME - Motif discovery tool
********************************************************************************
MEME version 3.0 (Release date: 2004/08/18 09:07:01)
...</pre>
</div>
<p>Further down, the input set of training sequences is recapitulated:</p>
<div class="code python highlight-python"><pre>********************************************************************************
TRAINING SET
********************************************************************************
DATAFILE= INO_up800.s
ALPHABET= ACGT
Sequence name            Weight Length  Sequence name            Weight Length
-------------            ------ ------  -------------            ------ ------
CHO1                     1.0000    800  CHO2                     1.0000    800
FAS1                     1.0000    800  FAS2                     1.0000    800
ACC1                     1.0000    800  INO1                     1.0000    800
OPI3                     1.0000    800
********************************************************************************</pre>
</div>
<p>and the exact command line that was used:</p>
<div class="code python highlight-python"><pre>********************************************************************************
COMMAND LINE SUMMARY
********************************************************************************
This information can also be useful in the event you wish to report a
problem with the MEME software.

command: meme -mod oops -dna -revcomp -nmotifs 2 -bfile yeast.nc.6.freq INO_up800.s
...</pre>
</div>
<p>Next is detailed information on each motif that was found:</p>
<div class="code python highlight-python"><pre>********************************************************************************
MOTIF  1        width =   12   sites =   7   llr = 95   E-value = 2.0e-001
********************************************************************************
--------------------------------------------------------------------------------
        Motif 1 Description
--------------------------------------------------------------------------------
Simplified        A  :::9:a::::3:
pos.-specific     C  ::a:9:11691a
probability       G  ::::1::94:4:
matrix            T  aa:1::9::11:</pre>
</div>
<p>To parse this file (stored as <tt class="docutils literal"><span class="pre">meme.dna.oops.txt</span></tt>), use</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;meme.dna.oops.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s">&quot;meme&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">motifs.parse</span></tt> command reads the complete file directly, so you
can close the file after calling <tt class="docutils literal"><span class="pre">motifs.parse</span></tt>. The header
information is stored in attributes:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">version</span>
<span class="go">&#39;3.0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">datafile</span>
<span class="go">&#39;INO_up800.s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">command</span>
<span class="go">&#39;meme -mod oops -dna -revcomp -nmotifs 2 -bfile yeast.nc.6.freq INO_up800.s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">alphabet</span>
<span class="go">IUPACUnambiguousDNA()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">sequences</span>
<span class="go">[&#39;CHO1&#39;, &#39;CHO2&#39;, &#39;FAS1&#39;, &#39;FAS2&#39;, &#39;ACC1&#39;, &#39;INO1&#39;, &#39;OPI3&#39;]</span>
</pre></div>
</div>
<p>The record is an object of the <tt class="docutils literal"><span class="pre">Bio.motifs.meme.Record</span></tt> class. The
class inherits from list, and you can think of <tt class="docutils literal"><span class="pre">record</span></tt> as a list of
Motif objects:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">motif</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">TTCACATGCCGC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">motif</span><span class="o">.</span><span class="n">degenerate_consensus</span>
<span class="go">TTCACATGSCNC</span>
</pre></div>
</div>
<p>In addition to these generic motif attributes, each motif also stores
its specific information as calculated by MEME. For example,</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">num_occurrences</span>
<span class="go">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">length</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evalue</span> <span class="o">=</span> <span class="n">motif</span><span class="o">.</span><span class="n">evalue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%3.1g</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">evalue</span>
<span class="go">0.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;Motif 1&#39;</span>
</pre></div>
</div>
<p>In addition to using an index into the record, as we did above, you can
also find it by its name:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s">&#39;Motif 1&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Each motif has an attribute <tt class="docutils literal"><span class="pre">.instances</span></tt> with the sequence instances
in which the motif was found, providing some information on each
instance:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">motif</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Instance(&#39;TTCACATGCCGC&#39;, IUPACUnambiguousDNA())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">motif_name</span>
<span class="go">&#39;Motif 1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sequence_name</span>
<span class="go">&#39;INO1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
<span class="go">620</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strand</span>
<span class="go">&#39;-&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pvalue</span> <span class="o">=</span> <span class="n">motif</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%5.3g</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">pvalue</span>
<span class="go">1.85e-08</span>
</pre></div>
</div>
</div>
<div class="section" id="mast">
<h4>MAST<a class="headerlink" href="#mast" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="transfac">
<h4>TRANSFAC<a class="headerlink" href="#transfac" title="Permalink to this headline">¶</a></h4>
<p>TRANSFAC is a manually curated database of transcription factors,
together with their genomic binding sites and DNA binding profiles
[<a class="reference external" href="#matys2003">27</a>]. While the file format used in the TRANSFAC
database is nowadays also used by others, we will refer to it as the
TRANSFAC file format.</p>
<p>A minimal file in the TRANSFAC format looks as follows:</p>
<div class="code python highlight-python"><pre>ID  motif1
P0      A      C      G      T
01      1      2      2      0      S
02      2      1      2      0      R
03      3      0      1      1      A
04      0      5      0      0      C
05      5      0      0      0      A
06      0      0      4      1      G
07      0      1      4      0      G
08      0      0      0      5      T
09      0      0      5      0      G
10      0      1      2      2      K
11      0      2      0      3      Y
12      1      0      3      1      G
//</pre>
</div>
<p>This file shows the frequency matrix of motif <tt class="docutils literal"><span class="pre">motif1</span></tt> of 12
nucleotides. In general, one file in the TRANSFAC format can contain
multiple motifs. For example, this is the contents of the example
TRANSFAC file <tt class="docutils literal"><span class="pre">transfac.dat</span></tt>:</p>
<div class="code python highlight-python"><pre>VV  EXAMPLE January 15, 2013
XX
//
ID  motif1
P0      A      C      G      T
01      1      2      2      0      S
02      2      1      2      0      R
03      3      0      1      1      A
...
11      0      2      0      3      Y
12      1      0      3      1      G
//
ID  motif2
P0      A      C      G      T
01      2      1      2      0      R
02      1      2      2      0      S
...
09      0      0      0      5      T
10      0      2      0      3      Y
//</pre>
</div>
<p>To parse a TRANSFAC file, use</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;transfac.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s">&quot;TRANSFAC&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The overall version number, if available, is stored as
<tt class="docutils literal"><span class="pre">record.version</span></tt>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">version</span>
<span class="go">&#39;EXAMPLE January 15, 2013&#39;</span>
</pre></div>
</div>
<p>Each motif in <tt class="docutils literal"><span class="pre">record</span></tt> is in instance of the
<tt class="docutils literal"><span class="pre">Bio.motifs.transfac.Motif</span></tt> class, which inherits both from the
<tt class="docutils literal"><span class="pre">Bio.motifs.Motif</span></tt> class and from a Python dictionary. The dictionary
uses the two-letter keys to store any additional information about the
motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">degenerate_consensus</span> <span class="c"># Using the Bio.motifs.Motif method</span>
<span class="go">Seq(&#39;SRACAGGTGKYG&#39;, IUPACAmbiguousDNA())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="p">[</span><span class="s">&#39;ID&#39;</span><span class="p">]</span> <span class="c"># Using motif as a dictionary</span>
<span class="go">&#39;motif1&#39;</span>
</pre></div>
</div>
<p>TRANSFAC files are typically much more elaborate than this example,
containing lots of additional information about the motif. Table
<a class="reference external" href="#table:transfaccodes">14.1.2</a> lists the two-letter field codes that
are commonly found in TRANSFAC files:</p>
<hr class="docutils" />
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Table 14.1: Fields commonly found in TRANSFAC files</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">AC</span></tt></td>
<td>Accession number</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">AS</span></tt></td>
<td>Accession numbers, secondary</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">BA</span></tt></td>
<td>Statistical basis</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">BF</span></tt></td>
<td>Binding factors</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">BS</span></tt></td>
<td>Factor binding sites underlying the matrix</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">CC</span></tt></td>
<td>Comments</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">CO</span></tt></td>
<td>Copyright notice</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">DE</span></tt></td>
<td>Short factor description</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">DR</span></tt></td>
<td>External databases</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">DT</span></tt></td>
<td>Date created/updated</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">HC</span></tt></td>
<td>Subfamilies</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">HP</span></tt></td>
<td>Superfamilies</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ID</span></tt></td>
<td>Identifier</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">NA</span></tt></td>
<td>Name of the binding factor</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">OC</span></tt></td>
<td>Taxonomic classification</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">OS</span></tt></td>
<td>Species/Taxon</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">OV</span></tt></td>
<td>Older version</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">PV</span></tt></td>
<td>Preferred version</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">TY</span></tt></td>
<td>Type</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">XX</span></tt></td>
<td>Empty line; these are not stored in the Record.</td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<p>Each motif also has an attribute <tt class="docutils literal"><span class="pre">.references</span></tt> containing the
references associated with the motif, using these two-letter keys:</p>
<hr class="docutils" />
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Table 14.2: Fields used to store references in TRANSFAC files</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">RN</span></tt></td>
<td>Reference number</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">RA</span></tt></td>
<td>Reference authors</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">RL</span></tt></td>
<td>Reference data</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">RT</span></tt></td>
<td>Reference title</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">RX</span></tt></td>
<td>PubMed ID</td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<p>Printing the motifs writes them out in their native TRANSFAC format:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">record</span>
<span class="go">VV  EXAMPLE January 15, 2013</span>
<span class="go">XX</span>
<span class="go">//</span>
<span class="go">ID  motif1</span>
<span class="go">XX</span>
<span class="go">P0      A      C      G      T</span>
<span class="go">01      1      2      2      0      S</span>
<span class="go">02      2      1      2      0      R</span>
<span class="go">03      3      0      1      1      A</span>
<span class="go">04      0      5      0      0      C</span>
<span class="go">05      5      0      0      0      A</span>
<span class="go">06      0      0      4      1      G</span>
<span class="go">07      0      1      4      0      G</span>
<span class="go">08      0      0      0      5      T</span>
<span class="go">09      0      0      5      0      G</span>
<span class="go">10      0      1      2      2      K</span>
<span class="go">11      0      2      0      3      Y</span>
<span class="go">12      1      0      3      1      G</span>
<span class="go">XX</span>
<span class="go">//</span>
<span class="go">ID  motif2</span>
<span class="go">XX</span>
<span class="go">P0      A      C      G      T</span>
<span class="go">01      2      1      2      0      R</span>
<span class="go">02      1      2      2      0      S</span>
<span class="go">03      0      5      0      0      C</span>
<span class="go">04      3      0      1      1      A</span>
<span class="go">05      0      0      4      1      G</span>
<span class="go">06      5      0      0      0      A</span>
<span class="go">07      0      1      4      0      G</span>
<span class="go">08      0      0      5      0      G</span>
<span class="go">09      0      0      0      5      T</span>
<span class="go">10      0      2      0      3      Y</span>
<span class="go">XX</span>
<span class="go">//</span>
</pre></div>
</div>
<p>You can export the motifs in the TRANSFAC format by capturing this
output in a string and saving it in a file:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;mytransfacfile.dat&quot;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="writing-motifs">
<h3>14.1.3  Writing motifs<a class="headerlink" href="#writing-motifs" title="Permalink to this headline">¶</a></h3>
<p>Speaking of exporting, let’s look at export functions in general. To
export a motif in the JASPAR <tt class="docutils literal"><span class="pre">.pfm</span></tt> format, use</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;pfm&quot;</span><span class="p">)</span>
<span class="go">3       7       0       2       1</span>
<span class="go">0       0       5       2       6</span>
<span class="go">0       0       0       3       0</span>
<span class="go">4       0       2       0       0</span>
</pre></div>
</div>
<p>To write the motif in a TRANSFAC-like matrix format, use</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;transfac&quot;</span><span class="p">)</span>
<span class="go">P0      A      C      G      T</span>
<span class="go">01      3      0      0      4      W</span>
<span class="go">02      7      0      0      0      A</span>
<span class="go">03      0      5      0      2      C</span>
<span class="go">04      2      2      3      0      V</span>
<span class="go">05      1      6      0      0      C</span>
<span class="go">XX</span>
<span class="go">//</span>
</pre></div>
</div>
<p>To write out multiple motifs, you can use <tt class="docutils literal"><span class="pre">motifs.write</span></tt>. This
function can be used regardless of whether the motifs originated from a
TRANSFAC file. For example,</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">two_motifs</span> <span class="o">=</span> <span class="p">[</span><span class="n">arnt</span><span class="p">,</span> <span class="n">srf</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">motifs</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">two_motifs</span><span class="p">,</span> <span class="s">&#39;transfac&#39;</span><span class="p">)</span>
<span class="go">P0      A      C      G      T</span>
<span class="go">01      4     16      0      0      C</span>
<span class="go">02     19      0      1      0      A</span>
<span class="go">03      0     20      0      0      C</span>
<span class="go">04      0      0     20      0      G</span>
<span class="go">05      0      0      0     20      T</span>
<span class="go">06      0      0     20      0      G</span>
<span class="go">XX</span>
<span class="go">//</span>
<span class="go">P0      A      C      G      T</span>
<span class="go">01      2      1     39      4      G</span>
<span class="go">02      9     33      2      2      C</span>
<span class="go">03      0     45      1      0      C</span>
<span class="go">04      1     45      0      0      C</span>
<span class="go">05     32      1      0     13      A</span>
<span class="go">06      3      1      0     42      T</span>
<span class="go">07     46      0      0      0      A</span>
<span class="go">08      1      0      0     45      T</span>
<span class="go">09     43      0      0      3      A</span>
<span class="go">10     15      1      0     30      T</span>
<span class="go">11      2      0     44      0      G</span>
<span class="go">12      2      1     43      0      G</span>
<span class="go">XX</span>
<span class="go">//</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-sequence-logo">
<h3>14.1.4  Creating a sequence logo<a class="headerlink" href="#creating-a-sequence-logo" title="Permalink to this headline">¶</a></h3>
<p>If we have internet access, we can create a
<a class="reference external" href="http://weblogo.berkeley.edu">weblogo</a>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">arnt</span><span class="o">.</span><span class="n">weblogo</span><span class="p">(</span><span class="s">&quot;Arnt.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We should get our logo saved as a PNG in the specified file.</p>
</div>
</div>
<div class="section" id="position-weight-matrices">
<h2>14.2  Position-Weight Matrices<a class="headerlink" href="#position-weight-matrices" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">.counts</span></tt> attribute of a Motif object shows how often each
nucleotide appeared at each position along the alignment. We can
normalize this matrix by dividing by the number of instances in the
alignment, resulting in the probability of each nucleotide at each
position along the alignment. We refer to these probabilities as the
position-weight matrix. However, beware that in the literature this term
may also be used to refer to the position-specific scoring matrix, which
we discuss below.</p>
<p>Usually, pseudocounts are added to each position before normalizing.
This avoids overfitting of the position-weight matrix to the limited
number of motif instances in the alignment, and can also prevent
probabilities from becoming zero. To add a fixed pseudocount to all
nucleotides at all positions, specify a number for the <tt class="docutils literal"><span class="pre">pseudocounts</span></tt>
argument:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pwm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pseudocounts</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">pwm</span>
<span class="go">        0      1      2      3      4</span>
<span class="go">A:   0.39   0.83   0.06   0.28   0.17</span>
<span class="go">C:   0.06   0.06   0.61   0.28   0.72</span>
<span class="go">G:   0.06   0.06   0.06   0.39   0.06</span>
<span class="go">T:   0.50   0.06   0.28   0.06   0.06</span>
</pre></div>
</div>
<p>Alternatively, <tt class="docutils literal"><span class="pre">pseudocounts</span></tt> can be a dictionary specifying the
pseudocounts for each nucleotide. For example, as the GC content of the
human genome is about 40%, you may want to choose the pseudocounts
accordingly:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pwm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pseudocounts</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;A&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">&#39;T&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">pwm</span>
<span class="go">        0      1      2      3      4</span>
<span class="go">A:   0.40   0.84   0.07   0.29   0.18</span>
<span class="go">C:   0.04   0.04   0.60   0.27   0.71</span>
<span class="go">G:   0.04   0.04   0.04   0.38   0.04</span>
<span class="go">T:   0.51   0.07   0.29   0.07   0.07</span>
</pre></div>
</div>
<p>The position-weight matrix has its own methods to calculate the
consensus, anticonsensus, and degenerate consensus sequences:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pwm</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">Seq(&#39;TACGC&#39;, IUPACUnambiguousDNA())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwm</span><span class="o">.</span><span class="n">anticonsensus</span>
<span class="go">Seq(&#39;GGGTG&#39;, IUPACUnambiguousDNA())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwm</span><span class="o">.</span><span class="n">degenerate_consensus</span>
<span class="go">Seq(&#39;WACNC&#39;, IUPACAmbiguousDNA())</span>
</pre></div>
</div>
<p>Note that due to the pseudocounts, the degenerate consensus sequence
calculated from the position-weight matrix is slightly different from
the degenerate consensus sequence calculated from the instances in the
motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">degenerate_consensus</span>
<span class="go">Seq(&#39;WACVC&#39;, IUPACAmbiguousDNA())</span>
</pre></div>
</div>
<p>The reverse complement of the position-weight matrix can be calculated
directly from the <tt class="docutils literal"><span class="pre">pwm</span></tt>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">rpwm</span> <span class="o">=</span> <span class="n">pwm</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">rpwm</span>
<span class="go">        0      1      2      3      4</span>
<span class="go">A:   0.07   0.07   0.29   0.07   0.51</span>
<span class="go">C:   0.04   0.38   0.04   0.04   0.04</span>
<span class="go">G:   0.71   0.27   0.60   0.04   0.04</span>
<span class="go">T:   0.18   0.29   0.07   0.84   0.40</span>
</pre></div>
</div>
</div>
<div class="section" id="position-specific-scoring-matrices">
<h2>14.3  Position-Specific Scoring Matrices<a class="headerlink" href="#position-specific-scoring-matrices" title="Permalink to this headline">¶</a></h2>
<p>Using the background distribution and PWM with pseudo-counts added, it’s
easy to compute the log-odds ratios, telling us what are the log odds of
a particular symbol to be coming from a motif against the background. We
can use the <tt class="docutils literal"><span class="pre">.log_odds()</span></tt> method on the position-weight matrix:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pssm</span> <span class="o">=</span> <span class="n">pwm</span><span class="o">.</span><span class="n">log_odds</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">pssm</span>
<span class="go">        0      1      2      3      4</span>
<span class="go">A:   0.68   1.76  -1.91   0.21  -0.49</span>
<span class="go">C:  -2.49  -2.49   1.26   0.09   1.51</span>
<span class="go">G:  -2.49  -2.49  -2.49   0.60  -2.49</span>
<span class="go">T:   1.03  -1.91   0.21  -1.91  -1.91</span>
</pre></div>
</div>
<p>Here we can see positive values for symbols more frequent in the motif
than in the background and negative for symbols more frequent in the
background. 0.0 means that it’s equally likely to see a symbol in the
background and in the motif.</p>
<p>This assumes that A, C, G, and T are equally likely in the background.
To calculate the position-specific scoring matrix against a background
with unequal probabilities for A, C, G, T, use the <tt class="docutils literal"><span class="pre">background</span></tt>
argument. For example, against a background with a 40% GC content, use</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">background</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;A&#39;</span><span class="p">:</span><span class="mf">0.3</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span><span class="s">&#39;G&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span><span class="s">&#39;T&#39;</span><span class="p">:</span><span class="mf">0.3</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pssm</span> <span class="o">=</span> <span class="n">pwm</span><span class="o">.</span><span class="n">log_odds</span><span class="p">(</span><span class="n">background</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">pssm</span>
<span class="go">        0      1      2      3      4</span>
<span class="go">A:   0.42   1.49  -2.17  -0.05  -0.75</span>
<span class="go">C:  -2.17  -2.17   1.58   0.42   1.83</span>
<span class="go">G:  -2.17  -2.17  -2.17   0.92  -2.17</span>
<span class="go">T:   0.77  -2.17  -0.05  -2.17  -2.17</span>
</pre></div>
</div>
<p>The maximum and minimum score obtainable from the PSSM are stored in the
<tt class="docutils literal"><span class="pre">.max</span></tt> and <tt class="docutils literal"><span class="pre">.min</span></tt> properties:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%4.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">pssm</span><span class="o">.</span><span class="n">max</span>
<span class="go">6.59</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%4.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">pssm</span><span class="o">.</span><span class="n">min</span>
<span class="go">-10.85</span>
</pre></div>
</div>
<p>The mean and standard deviation of the PSSM scores with respect to a
specific background are calculated by the <tt class="docutils literal"><span class="pre">.mean</span></tt> and <tt class="docutils literal"><span class="pre">.std</span></tt>
methods.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">pssm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">background</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">std</span> <span class="o">=</span> <span class="n">pssm</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">background</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;mean = </span><span class="si">%0.2f</span><span class="s">, standard deviation = </span><span class="si">%0.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
<span class="go">mean = 3.21, standard deviation = 2.59</span>
</pre></div>
</div>
<p>A uniform background is used if <tt class="docutils literal"><span class="pre">background</span></tt> is not specified. The
mean is particularly important, as its value is equal to the
Kullback-Leibler divergence or relative entropy, and is a measure for
the information content of the motif compared to the background. As in
Biopython the base-2 logarithm is used in the calculation of the
log-odds scores, the information content has units of bits.</p>
<p>The <tt class="docutils literal"><span class="pre">.reverse_complement</span></tt>, <tt class="docutils literal"><span class="pre">.consensus</span></tt>, <tt class="docutils literal"><span class="pre">.anticonsensus</span></tt>, and
<tt class="docutils literal"><span class="pre">.degenerate_consensus</span></tt> methods can be applied directly to PSSM
objects.</p>
</div>
<div class="section" id="searching-for-instances">
<h2>14.4  Searching for instances<a class="headerlink" href="#searching-for-instances" title="Permalink to this headline">¶</a></h2>
<p>The most frequent use for a motif is to find its instances in some
sequence. For the sake of this section, we will use an artificial
sequence like this:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">test_seq</span><span class="o">=</span><span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TACACTGCATTACAACCCAAGCATTA&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">test_seq</span><span class="p">)</span>
<span class="go">26</span>
</pre></div>
</div>
<div class="section" id="searching-for-exact-matches">
<h3>14.4.1  Searching for exact matches<a class="headerlink" href="#searching-for-exact-matches" title="Permalink to this headline">¶</a></h3>
<p>The simplest way to find instances, is to look for exact matches of the
true instances of the motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pos</span><span class="p">,</span><span class="n">seq</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">test_seq</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">pos</span><span class="p">,</span> <span class="n">seq</span>
<span class="gp">...</span>
<span class="go">0 TACAC</span>
<span class="go">10 TACAA</span>
<span class="go">13 AACCC</span>
</pre></div>
</div>
<p>We can do the same with the reverse complement (to find instances on the
complementary strand):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pos</span><span class="p">,</span><span class="n">seq</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">test_seq</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">pos</span><span class="p">,</span> <span class="n">seq</span>
<span class="gp">...</span>
<span class="go">6 GCATT</span>
<span class="go">20 GCATT</span>
</pre></div>
</div>
</div>
<div class="section" id="searching-for-matches-using-the-pssm-score">
<h3>14.4.2  Searching for matches using the PSSM score<a class="headerlink" href="#searching-for-matches-using-the-pssm-score" title="Permalink to this headline">¶</a></h3>
<p>It’s just as easy to look for positions, giving rise to high log-odds
scores against our motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">position</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">pssm</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">test_seq</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&quot;Position </span><span class="si">%d</span><span class="s">: score = </span><span class="si">%5.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">Position 0: score = 5.622</span>
<span class="go">Position -20: score = 4.601</span>
<span class="go">Position 10: score = 3.037</span>
<span class="go">Position 13: score = 5.738</span>
<span class="go">Position -6: score = 4.601</span>
</pre></div>
</div>
<p>The negative positions refer to instances of the motif found on the
reverse strand of the test sequence, and follow the Python convention on
negative indices. Therefore, the instance of the motif at <tt class="docutils literal"><span class="pre">pos</span></tt> is
located at <tt class="docutils literal"><span class="pre">test_seq[pos:pos+len(m)]</span></tt> both for positive and for
negative values of <tt class="docutils literal"><span class="pre">pos</span></tt>.</p>
<p>You may notice the threshold parameter, here set arbitrarily to 3.0.
This is in <em>log</em><sub>2</sub>, so we are now looking only for words, which
are eight times more likely to occur under the motif model than in the
background. The default threshold is 0.0, which selects everything that
looks more like the motif than the background.</p>
<p>You can also calculate the scores at all positions along the sequence:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pssm</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">test_seq</span><span class="p">)</span>
<span class="go">array([  5.62230396,  -5.6796999 ,  -3.43177247,   0.93827754,</span>
<span class="go">        -6.84962511,  -2.04066086, -10.84962463,  -3.65614533,</span>
<span class="go">        -0.03370807,  -3.91102552,   3.03734159,  -2.14918518,</span>
<span class="go">        -0.6016975 ,   5.7381525 ,  -0.50977498,  -3.56422281,</span>
<span class="go">        -8.73414803,  -0.09919716,  -0.6016975 ,  -2.39429784,</span>
<span class="go">       -10.84962463,  -3.65614533], dtype=float32)</span>
</pre></div>
</div>
<p>In general, this is the fastest way to calculate PSSM scores. The scores
returned by <tt class="docutils literal"><span class="pre">pssm.calculate</span></tt> are for the forward strand only. To
obtain the scores on the reverse strand, you can take the reverse
complement of the PSSM:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">rpssm</span> <span class="o">=</span> <span class="n">pssm</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rpssm</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">test_seq</span><span class="p">)</span>
<span class="go">array([ -9.43458748,  -3.06172252,  -7.18665981,  -7.76216221,</span>
<span class="go">        -2.04066086,  -4.26466274,   4.60124254,  -4.2480607 ,</span>
<span class="go">        -8.73414803,  -2.26503372,  -6.49598789,  -5.64668512,</span>
<span class="go">        -8.73414803, -10.84962463,  -4.82356262,  -4.82356262,</span>
<span class="go">        -5.64668512,  -8.73414803,  -4.15613794,  -5.6796999 ,</span>
<span class="go">         4.60124254,  -4.2480607 ], dtype=float32)</span>
</pre></div>
</div>
</div>
<div class="section" id="selecting-a-score-threshold">
<h3>14.4.3  Selecting a score threshold<a class="headerlink" href="#selecting-a-score-threshold" title="Permalink to this headline">¶</a></h3>
<p>If you want to use a less arbitrary way of selecting thresholds, you can
explore the distribution of PSSM scores. Since the space for a score
distribution grows exponentially with motif length, we are using an
approximation with a given precision to keep computation cost
manageable:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">distribution</span> <span class="o">=</span> <span class="n">pssm</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">distribution</span></tt> object can be used to determine a number of
different thresholds. We can specify the requested false-positive rate
(probability of “finding” a motif instance in background generated
sequence):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">threshold_fpr</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%5.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">threshold</span>
<span class="go">4.009</span>
</pre></div>
</div>
<p>or the false-negative rate (probability of “not finding” an instance
generated from the motif):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">threshold_fnr</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%5.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">threshold</span>
<span class="go">-0.510</span>
</pre></div>
</div>
<p>or a threshold (approximately) satisfying some relation between the
false-positive rate and the false-negative rate (fnr/fpr≃ <em>t</em>):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">threshold_balanced</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%5.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">threshold</span>
<span class="go">6.241</span>
</pre></div>
</div>
<p>or a threshold satisfying (roughly) the equality between the
false-positive rate and the −<em>log</em> of the information content (as used
in patser software by Hertz and Stormo):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">threshold_patser</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%5.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">threshold</span>
<span class="go">0.346</span>
</pre></div>
</div>
<p>For example, in case of our motif, you can get the threshold giving you
exactly the same results (for this sequence) as searching for instances
with balanced threshold with rate of 1000.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">threshold_fpr</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%5.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">threshold</span>
<span class="go">4.009</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">position</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">pssm</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">test_seq</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&quot;Position </span><span class="si">%d</span><span class="s">: score = </span><span class="si">%5.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">Position 0: score = 5.622</span>
<span class="go">Position -20: score = 4.601</span>
<span class="go">Position 13: score = 5.738</span>
<span class="go">Position -6: score = 4.601</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="each-motif-object-has-an-associated-position-specific-scoring-matrix">
<h2>14.5  Each motif object has an associated Position-Specific Scoring Matrix<a class="headerlink" href="#each-motif-object-has-an-associated-position-specific-scoring-matrix" title="Permalink to this headline">¶</a></h2>
<p>To facilitate searching for potential TFBSs using PSSMs, both the
position-weight matrix and the position-specific scoring matrix are
associated with each motif. Using the Arnt motif as an example:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">motifs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;Arnt.sites&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s">&#39;sites&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">motif</span><span class="o">.</span><span class="n">counts</span>
<span class="go">        0      1      2      3      4      5</span>
<span class="go">A:   4.00  19.00   0.00   0.00   0.00   0.00</span>
<span class="go">C:  16.00   0.00  20.00   0.00   0.00   0.00</span>
<span class="go">G:   0.00   1.00   0.00  20.00   0.00  20.00</span>
<span class="go">T:   0.00   0.00   0.00   0.00  20.00   0.00</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">motif</span><span class="o">.</span><span class="n">pwm</span>
<span class="go">        0      1      2      3      4      5</span>
<span class="go">A:   0.20   0.95   0.00   0.00   0.00   0.00</span>
<span class="go">C:   0.80   0.00   1.00   0.00   0.00   0.00</span>
<span class="go">G:   0.00   0.05   0.00   1.00   0.00   1.00</span>
<span class="go">T:   0.00   0.00   0.00   0.00   1.00   0.00</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">motif</span><span class="o">.</span><span class="n">pssm</span>
<span class="go">        0      1      2      3      4      5</span>
<span class="go">A:  -0.32   1.93   -inf   -inf   -inf   -inf</span>
<span class="go">C:   1.68   -inf   2.00   -inf   -inf   -inf</span>
<span class="go">G:   -inf  -2.32   -inf   2.00   -inf   2.00</span>
<span class="go">T:   -inf   -inf   -inf   -inf   2.00   -inf</span>
</pre></div>
</div>
<p>The negative infinities appear here because the corresponding entry in
the frequency matrix is 0, and we are using zero pseudocounts by
default:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="s">&quot;ACGT&quot;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%4.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">motif</span><span class="o">.</span><span class="n">pseudocounts</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">A: 0.00</span>
<span class="go">C: 0.00</span>
<span class="go">G: 0.00</span>
<span class="go">T: 0.00</span>
</pre></div>
</div>
<p>If you change the <tt class="docutils literal"><span class="pre">.pseudocounts</span></tt> attribute, the position-frequency
matrix and the position-specific scoring matrix are recalculated
automatically:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">pseudocounts</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="s">&quot;ACGT&quot;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%4.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">motif</span><span class="o">.</span><span class="n">pseudocounts</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">A: 3.00</span>
<span class="go">C: 3.00</span>
<span class="go">G: 3.00</span>
<span class="go">T: 3.00</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">motif</span><span class="o">.</span><span class="n">pwm</span>
<span class="go">        0      1      2      3      4      5</span>
<span class="go">A:   0.22   0.69   0.09   0.09   0.09   0.09</span>
<span class="go">C:   0.59   0.09   0.72   0.09   0.09   0.09</span>
<span class="go">G:   0.09   0.12   0.09   0.72   0.09   0.72</span>
<span class="go">T:   0.09   0.09   0.09   0.09   0.72   0.09</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">motif</span><span class="o">.</span><span class="n">pssm</span>
<span class="go">        0      1      2      3      4      5</span>
<span class="go">A:  -0.19   1.46  -1.42  -1.42  -1.42  -1.42</span>
<span class="go">C:   1.25  -1.42   1.52  -1.42  -1.42  -1.42</span>
<span class="go">G:  -1.42  -1.00  -1.42   1.52  -1.42   1.52</span>
<span class="go">T:  -1.42  -1.42  -1.42  -1.42   1.52  -1.42</span>
</pre></div>
</div>
<p>You can also set the <tt class="docutils literal"><span class="pre">.pseudocounts</span></tt> to a dictionary over the four
nucleotides if you want to use different pseudocounts for them. Setting
<tt class="docutils literal"><span class="pre">motif.pseudocounts</span></tt> to <tt class="docutils literal"><span class="pre">None</span></tt> resets it to its default value of
zero.</p>
<p>The position-specific scoring matrix depends on the background
distribution, which is uniform by default:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="s">&quot;ACGT&quot;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%4.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">motif</span><span class="o">.</span><span class="n">background</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">A: 0.25</span>
<span class="go">C: 0.25</span>
<span class="go">G: 0.25</span>
<span class="go">T: 0.25</span>
</pre></div>
</div>
<p>Again, if you modify the background distribution, the position-specific
scoring matrix is recalculated:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;A&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s">&#39;T&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">motif</span><span class="o">.</span><span class="n">pssm</span>
<span class="go">        0      1      2      3      4      5</span>
<span class="go">A:   0.13   1.78  -1.09  -1.09  -1.09  -1.09</span>
<span class="go">C:   0.98  -1.68   1.26  -1.68  -1.68  -1.68</span>
<span class="go">G:  -1.68  -1.26  -1.68   1.26  -1.68   1.26</span>
<span class="go">T:  -1.09  -1.09  -1.09  -1.09   1.85  -1.09</span>
</pre></div>
</div>
<p>Setting <tt class="docutils literal"><span class="pre">motif.background</span></tt> to <tt class="docutils literal"><span class="pre">None</span></tt> resets it to a uniform
distribution:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="s">&quot;ACGT&quot;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%4.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">motif</span><span class="o">.</span><span class="n">background</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">A: 0.25</span>
<span class="go">C: 0.25</span>
<span class="go">G: 0.25</span>
<span class="go">T: 0.25</span>
</pre></div>
</div>
<p>If you set <tt class="docutils literal"><span class="pre">motif.background</span></tt> equal to a single value, it will be
interpreted as the GC content:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motif</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="s">&quot;ACGT&quot;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%4.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">motif</span><span class="o">.</span><span class="n">background</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">A: 0.10</span>
<span class="go">C: 0.40</span>
<span class="go">G: 0.40</span>
<span class="go">T: 0.10</span>
</pre></div>
</div>
<p>Note that you can now calculate the mean of the PSSM scores over the
background against which it was computed:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">motif</span><span class="o">.</span><span class="n">pssm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">motif</span><span class="o">.</span><span class="n">background</span><span class="p">)</span>
<span class="go">4.703928</span>
</pre></div>
</div>
<p>as well as its standard deviation:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">motif</span><span class="o">.</span><span class="n">pssm</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">motif</span><span class="o">.</span><span class="n">background</span><span class="p">)</span>
<span class="go">3.290900</span>
</pre></div>
</div>
<p>and its distribution:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">distribution</span> <span class="o">=</span> <span class="n">motif</span><span class="o">.</span><span class="n">pssm</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="n">motif</span><span class="o">.</span><span class="n">background</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">threshold_fpr</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">threshold</span>
<span class="go">3.854375</span>
</pre></div>
</div>
<p>Note that the position-weight matrix and the position-specific scoring
matrix are recalculated each time you call <tt class="docutils literal"><span class="pre">motif.pwm</span></tt> or
<tt class="docutils literal"><span class="pre">motif.pssm</span></tt>, respectively. If speed is an issue and you want to use
the PWM or PSSM repeatedly, you can save them as a variable, as in</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pssm</span> <span class="o">=</span> <span class="n">motif</span><span class="o">.</span><span class="n">pssm</span>
</pre></div>
</div>
</div>
<div class="section" id="comparing-motifs">
<h2>14.6  Comparing motifs<a class="headerlink" href="#comparing-motifs" title="Permalink to this headline">¶</a></h2>
<p>Once we have more than one motif, we might want to compare them.</p>
<p>Before we start comparing motifs, I should point out that motif
boundaries are usually quite arbitrary. This means we often need to
compare motifs of different lengths, so comparison needs to involve some
kind of alignment. This means we have to take into account two things:</p>
<ul class="simple">
<li>alignment of motifs</li>
<li>some function to compare aligned motifs</li>
</ul>
<p>To align the motifs, we use ungapped alignment of PSSMs and substitute
zeros for any missing columns at the beginning and end of the matrices.
This means that effectively we are using the background distribution for
columns missing from the PSSM. The distance function then returns the
minimal distance between motifs, as well as the corresponding offset in
their alignment.</p>
<p>To give an exmaple, let us first load another motif, which is similar to
our test motif <tt class="docutils literal"><span class="pre">m</span></tt>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m_reb1</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;REB1.pfm&quot;</span><span class="p">),</span> <span class="s">&quot;pfm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m_reb1</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">Seq(&#39;GTTACCCGG&#39;, IUPACUnambiguousDNA())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m_reb1</span><span class="o">.</span><span class="n">counts</span>
<span class="go">        0      1      2      3      4      5      6      7      8</span>
<span class="go">A:  30.00   0.00   0.00 100.00   0.00   0.00   0.00   0.00  15.00</span>
<span class="go">C:  10.00   0.00   0.00   0.00 100.00 100.00 100.00   0.00  15.00</span>
<span class="go">G:  50.00   0.00   0.00   0.00   0.00   0.00   0.00  60.00  55.00</span>
<span class="go">T:  10.00 100.00 100.00   0.00   0.00   0.00   0.00  40.00  15.00</span>
</pre></div>
</div>
<p>To make the motifs comparable, we choose the same values for the
pseudocounts and the background distribution as our motif <tt class="docutils literal"><span class="pre">m</span></tt>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m_reb1</span><span class="o">.</span><span class="n">pseudocounts</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;A&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">&#39;T&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m_reb1</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;A&#39;</span><span class="p">:</span><span class="mf">0.3</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span><span class="s">&#39;G&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span><span class="s">&#39;T&#39;</span><span class="p">:</span><span class="mf">0.3</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pssm_reb1</span> <span class="o">=</span> <span class="n">m_reb1</span><span class="o">.</span><span class="n">pssm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">pssm_reb1</span>
<span class="go">        0      1      2      3      4      5      6      7      8</span>
<span class="go">A:   0.00  -5.67  -5.67   1.72  -5.67  -5.67  -5.67  -5.67  -0.97</span>
<span class="go">C:  -0.97  -5.67  -5.67  -5.67   2.30   2.30   2.30  -5.67  -0.41</span>
<span class="go">G:   1.30  -5.67  -5.67  -5.67  -5.67  -5.67  -5.67   1.57   1.44</span>
<span class="go">T:  -1.53   1.72   1.72  -5.67  -5.67  -5.67  -5.67   0.41  -0.97</span>
</pre></div>
</div>
<p>We’ll compare these motifs using the Pearson correlation. Since we want
it to resemble a distance measure, we actually take 1−<em>r</em>, where <em>r</em>
is the Pearson correlation coefficient (PCC):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">pssm</span><span class="o">.</span><span class="n">dist_pearson</span><span class="p">(</span><span class="n">pssm_reb1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;distance = </span><span class="si">%5.3g</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">distance</span>
<span class="go">distance = 0.239</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">offset</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>This means that the best PCC between motif <tt class="docutils literal"><span class="pre">m</span></tt> and <tt class="docutils literal"><span class="pre">m_reb1</span></tt> is
obtained with the following alignment:</p>
<div class="code python highlight-python"><pre>m:      bbTACGCbb
m_reb1: GTTACCCGG</pre>
</div>
<p>where <tt class="docutils literal"><span class="pre">b</span></tt> stands for background distribution. The PCC itself is
roughly 1−0.239=0.761.</p>
</div>
<div class="section" id="de-novo-motif-finding">
<h2>14.7  <em>De novo</em> motif finding<a class="headerlink" href="#de-novo-motif-finding" title="Permalink to this headline">¶</a></h2>
<p>Currently, Biopython has only limited support for <em>de novo</em> motif
finding. Namely, we support running and parsing of AlignAce and MEME.
Since the number of motif finding tools is growing rapidly,
contributions of new parsers are welcome.</p>
<div class="section" id="id1">
<h3>14.7.1  MEME<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Let’s assume, you have run MEME on sequences of your choice with your
favorite parameters and saved the output in the file <tt class="docutils literal"><span class="pre">meme.out</span></tt>. You
can retrieve the motifs reported by MEME by running the following piece
of code:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">motifs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;meme.out&quot;</span><span class="p">),</span> <span class="s">&quot;meme&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span>
<span class="go">[&lt;Bio.motifs.meme.Motif object at 0xc356b0&gt;]</span>
</pre></div>
</div>
<p>Besides the most wanted list of motifs, the result object contains more
useful information, accessible through properties with self-explanatory
names:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">.alphabet</span></tt></li>
<li><tt class="docutils literal"><span class="pre">.datafile</span></tt></li>
<li><tt class="docutils literal"><span class="pre">.sequence_names</span></tt></li>
<li><tt class="docutils literal"><span class="pre">.version</span></tt></li>
<li><tt class="docutils literal"><span class="pre">.command</span></tt></li>
</ul>
<p>The motifs returned by the MEME Parser can be treated exactly like
regular Motif objects (with instances), they also provide some extra
functionality, by adding additional information about the instances.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">Seq(&#39;CTCAATCGTA&#39;, IUPACUnambiguousDNA())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sequence_name</span>
<span class="go">&#39;SEQ10;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strand</span>
<span class="go">&#39;+&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pvalue</span>
<span class="go">8.71e-07</span>
</pre></div>
</div>
</div>
<div class="section" id="alignace">
<h3>14.7.2  AlignAce<a class="headerlink" href="#alignace" title="Permalink to this headline">¶</a></h3>
<p>We can do very similar things with the AlignACE program. Assume, you
have your output in the file <tt class="docutils literal"><span class="pre">alignace.out</span></tt>. You can parse your output
with the following code:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">motifs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsA</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;alignace.out&quot;</span><span class="p">),</span><span class="s">&quot;alignace&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Again, your motifs behave as they should:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">Seq(&#39;TCTACGATTGAG&#39;, IUPACUnambiguousDNA())</span>
</pre></div>
</div>
<p>In fact you can even see, that AlignAce found a very similar motif as
MEME. It is just a longer version of a reverse complement of the MEME
motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">()</span><span class="o">.</span><span class="n">consensus</span>
<span class="go">Seq(&#39;TACGATTGAG&#39;, IUPACUnambiguousDNA())</span>
</pre></div>
</div>
<p>If you have AlignAce installed on the same machine, you can also run it
directly from Biopython. A short example of how this can be done is
shown below (other parameters can be specified as keyword parameters):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">command</span><span class="o">=</span><span class="s">&quot;/opt/bin/AlignACE&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="s">&quot;test.fa&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.motifs.applications</span> <span class="kn">import</span> <span class="n">AlignAceCommandline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmd</span> <span class="o">=</span> <span class="n">AlignAceCommandline</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">command</span><span class="p">,</span><span class="nb">input</span><span class="o">=</span><span class="n">input_file</span><span class="p">,</span><span class="n">gcback</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">numcols</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stdout</span><span class="p">,</span><span class="n">stderr</span><span class="o">=</span> <span class="n">cmd</span><span class="p">()</span>
</pre></div>
</div>
<p>Since AlignAce prints all of its output to standard output, you can get
to your motifs by parsing the first part of the result:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifs</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="s">&quot;alignace&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="useful-links">
<h2>14.8  Useful links<a class="headerlink" href="#useful-links" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Sequence_motif">Sequence motif</a> in
wikipedia</li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Position_weight_matrix">PWM</a> in
wikipedia</li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Consensus_sequence">Consensus
sequence</a> in
wikipedia</li>
<li><a class="reference external" href="http://bio.cs.washington.edu/assessment/">Comparison of different motif finding
programs</a></li>
</ul>
</div>
<div class="section" id="obsolete-bio-motif-module">
<h2>14.9  Obsolete Bio.Motif module<a class="headerlink" href="#obsolete-bio-motif-module" title="Permalink to this headline">¶</a></h2>
<p>The rest of this chapter above describes the <tt class="docutils literal"><span class="pre">Bio.motifs</span></tt> package
included in Biopython 1.61 onwards, which is replacing the older
<tt class="docutils literal"><span class="pre">Bio.Motif</span></tt> package introduced with Biopython 1.50, which was in turn
based on two older former Biopython modules, <tt class="docutils literal"><span class="pre">Bio.AlignAce</span></tt> and
<tt class="docutils literal"><span class="pre">Bio.MEME</span></tt>.</p>
<p>To allow for a smooth transition, the older <tt class="docutils literal"><span class="pre">Bio.Motif</span></tt> package will
be maintained in parallel with its replacement <tt class="docutils literal"><span class="pre">Bio.motifs</span></tt> at least
two more releases, and at least one year.</p>
<div class="section" id="id2">
<h3>14.9.1  Motif objects<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Since we are interested in motif analysis, we need to take a look at
<tt class="docutils literal"><span class="pre">Motif</span></tt> objects in the first place. For that we need to import the
Motif library:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">Motif</span>
</pre></div>
</div>
<p>and we can start creating our first motif objects. Let’s create a DNA
motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.Alphabet</span> <span class="kn">import</span> <span class="n">IUPAC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Motif</span><span class="o">.</span><span class="n">Motif</span><span class="p">(</span><span class="n">alphabet</span><span class="o">=</span><span class="n">IUPAC</span><span class="o">.</span><span class="n">unambiguous_dna</span><span class="p">)</span>
</pre></div>
</div>
<p>This is for now just an empty container, so let’s add some sequences to
our newly created motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="kn">import</span> <span class="n">Seq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span><span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TATAA&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">alphabet</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span><span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TATTA&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">alphabet</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span><span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TATAA&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">alphabet</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span><span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TATAA&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">alphabet</span><span class="p">))</span>
</pre></div>
</div>
<p>Now we have a full <tt class="docutils literal"><span class="pre">Motif</span></tt> instance, so we can try to get some basic
information about it. Let’s start with length and consensus sequence:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">consensus</span><span class="p">()</span>
<span class="go">Seq(&#39;TATAA&#39;, IUPACUnambiguousDNA())</span>
</pre></div>
</div>
<p>In case of DNA motifs, we can also get a reverse complement of a motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">()</span><span class="o">.</span><span class="n">consensus</span><span class="p">()</span>
<span class="go">Seq(&#39;TTATA&#39;, IUPACUnambiguousDNA())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">()</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">i</span>
<span class="go">TTATA</span>
<span class="go">TAATA</span>
<span class="go">TTATA</span>
<span class="go">TTATA</span>
</pre></div>
</div>
<p>We can also calculate the information content of a motif with a simple
call:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;</span><span class="si">%0.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">m</span><span class="o">.</span><span class="n">ic</span><span class="p">()</span>
<span class="go">5.27</span>
</pre></div>
</div>
<p>This gives us a number of bits of information provided by the motif,
which tells us how much differs from background.</p>
<p>The most common representation of a motif is a PWM (Position Weight
Matrix). It summarizes the probabilities of finding any symbol (in this
case nucleotide) in any position of a motif. It can be computed by
calling the <tt class="docutils literal"><span class="pre">.pwm()</span></tt> method:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">pwm</span><span class="p">()</span>
<span class="go">[{&#39;A&#39;: 0.05, &#39;C&#39;: 0.05, &#39;T&#39;: 0.85, &#39;G&#39;: 0.05},</span>
<span class="go"> {&#39;A&#39;: 0.85, &#39;C&#39;: 0.05, &#39;T&#39;: 0.05, &#39;G&#39;: 0.05},</span>
<span class="go"> {&#39;A&#39;: 0.05, &#39;C&#39;: 0.05, &#39;T&#39;: 0.85, &#39;G&#39;: 0.05},</span>
<span class="go"> {&#39;A&#39;: 0.65, &#39;C&#39;: 0.05, &#39;T&#39;: 0.25, &#39;G&#39;: 0.05},</span>
<span class="go"> {&#39;A&#39;: 0.85, &#39;C&#39;: 0.05, &#39;T&#39;: 0.05, &#39;G&#39;: 0.05}]</span>
</pre></div>
</div>
<p>The probabilities in the motif’s PWM are based on the counts in the
instances, but we can see, that even though there were no Gs and no Cs
in the instances, we still have non-zero probabilities assigned to them.
These come from pseudo-counts which are, roughly speaking, a commonly
used way to acknowledge the incompleteness of our knowledge and avoid
technical problems with calculating logarithms of 0.</p>
<p>We can control the way that pseudo-counts are added with two properties
of Motif objects <tt class="docutils literal"><span class="pre">.background</span></tt> is the probability distribution over
all symbols in the alphabet that we assume represents background,
non-motif sequences (usually based on the GC content of the respective
genome). It is by default set to a uniform distribution upon creation of
a motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">background</span>
<span class="go">{&#39;A&#39;: 0.25, &#39;C&#39;: 0.25, &#39;T&#39;: 0.25, &#39;G&#39;: 0.25}</span>
</pre></div>
</div>
<p>The other parameter is <tt class="docutils literal"><span class="pre">.beta</span></tt>, which states the amount of
pseudo-counts we should add to the PWM. By default it is set to 1.0,</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">beta</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>so that the total input of pseudo-counts is equal to that of one
instance.</p>
<p>Using the background distribution and pwm with pseudo-counts added, it’s
easy to compute the log-odds ratios, telling us what are the log odds of
a particular symbol to be coming from a motif against the background. We
can use the <tt class="docutils literal"><span class="pre">.log_odds()</span></tt> method:</p>
<div class="code python highlight-python"><pre> &gt;&gt;&gt; m.log_odds()
[{'A': -2.3219280948873622,
  'C': -2.3219280948873622,
  'T': 1.7655347463629771,
  'G': -2.3219280948873622},
 {'A': 1.7655347463629771,
  'C': -2.3219280948873622,
  'T': -2.3219280948873622,
  'G': -2.3219280948873622},
 {'A': -2.3219280948873622,
  'C': -2.3219280948873622,
  'T': 1.7655347463629771,
  'G': -2.3219280948873622},
 {'A': 1.3785116232537298,
  'C': -2.3219280948873622,
  'T': 0.0,
  'G': -2.3219280948873622},
 {'A': 1.7655347463629771,
  'C': -2.3219280948873622,
  'T': -2.3219280948873622,
  'G': -2.3219280948873622}
]</pre>
</div>
<p>Here we can see positive values for symbols more frequent in the motif
than in the background and negative for symbols more frequent in the
background. 0.0 means that it’s equally likely to see a symbol in
background and in the motif (e.g. ‘T’ in the second-last position).</p>
<div class="section" id="reading-and-writing">
<h4>14.9.1.1  Reading and writing<a class="headerlink" href="#reading-and-writing" title="Permalink to this headline">¶</a></h4>
<p>Creating motifs from instances by hand is a bit boring, so it’s useful
to have some I/O functions for reading and writing motifs. There are no
really well established standards for storing motifs, but there’s a
couple of formats which are more used than others. The most important
distinction is whether the motif representation is based on instances or
on some version of PWM matrix. On of the most popular motif databases
<a class="reference external" href="http://jaspar.genereg.net">JASPAR</a> stores motifs in both formats, so
let’s look at how we can import JASPAR motifs from instances:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">Motif</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arnt</span> <span class="o">=</span> <span class="n">Motif</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;Arnt.sites&quot;</span><span class="p">),</span><span class="s">&quot;jaspar-sites&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>and from a count matrix:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">srf</span> <span class="o">=</span> <span class="n">Motif</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;SRF.pfm&quot;</span><span class="p">),</span><span class="s">&quot;jaspar-pfm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">arnt</span></tt> and <tt class="docutils literal"><span class="pre">srf</span></tt> motifs can both do the same things for us, but
they use different internal representations of the motif. We can tell
that by inspecting the <tt class="docutils literal"><span class="pre">has_counts</span></tt> and <tt class="docutils literal"><span class="pre">has_instances</span></tt> properties:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">arnt</span><span class="o">.</span><span class="n">has_instances</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">srf</span><span class="o">.</span><span class="n">has_instances</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">srf</span><span class="o">.</span><span class="n">has_counts</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">srf</span><span class="o">.</span><span class="n">counts</span>
<span class="go">{&#39;A&#39;: [2, 9, 0, 1, 32, 3, 46, 1, 43, 15, 2, 2],</span>
<span class="go"> &#39;C&#39;: [1, 33, 45, 45, 1, 1, 0, 0, 0, 1, 0, 1],</span>
<span class="go"> &#39;G&#39;: [39, 2, 1, 0, 0, 0, 0, 0, 0, 0, 44, 43],</span>
<span class="go"> &#39;T&#39;: [4, 2, 0, 0, 13, 42, 0, 45, 3, 30, 0, 0]}</span>
</pre></div>
</div>
<p>There are conversion functions, which can help us convert between
different representations:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">arnt</span><span class="o">.</span><span class="n">make_counts_from_instances</span><span class="p">()</span>
<span class="go">{&#39;A&#39;: [8, 38, 0, 0, 0, 0],</span>
<span class="go"> &#39;C&#39;: [32, 0, 40, 0, 0, 0],</span>
<span class="go"> &#39;G&#39;: [0, 2, 0, 40, 0, 40],</span>
<span class="go"> &#39;T&#39;: [0, 0, 0, 0, 40, 0]}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">srf</span><span class="o">.</span><span class="n">make_instances_from_counts</span><span class="p">()</span>
<span class="go">[Seq(&#39;GGGAAAAAAAGG&#39;, IUPACUnambiguousDNA()),</span>
<span class="go"> Seq(&#39;GGCCAAATAAGG&#39;, IUPACUnambiguousDNA()),</span>
<span class="go"> Seq(&#39;GACCAAATAAGG&#39;, IUPACUnambiguousDNA()),</span>
<span class="go">....</span>
</pre></div>
</div>
<p>The important thing to remember here is that the method
<tt class="docutils literal"><span class="pre">make_instances_from_counts()</span></tt> creates fake instances, because usually
there are very many possible sets of instances which give rise to the
same pwm, and if we have only the count matrix, we cannot reconstruct
the original one. This does not make any difference if we are using the
PWM as the representation of the motif, but one should be careful with
exporting instances from count-based motifs.</p>
<p>Speaking of exporting, let’s look at export functions. We can export to
fasta:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;fasta&quot;</span><span class="p">)</span>
<span class="go">&gt;instance0</span>
<span class="go">TATAA</span>
<span class="go">&gt;instance1</span>
<span class="go">TATTA</span>
<span class="go">&gt;instance2</span>
<span class="go">TATAA</span>
<span class="go">&gt;instance3</span>
<span class="go">TATAA</span>
</pre></div>
</div>
<p>or to TRANSFAC-like matrix format (used by some motif processing
software)</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;transfac&quot;</span><span class="p">)</span>
<span class="go">XX</span>
<span class="go">TY Motif</span>
<span class="go">ID</span>
<span class="go">BF undef</span>
<span class="go">P0 G A T C</span>
<span class="go">01 0 0 4 0</span>
<span class="go">02 0 4 0 0</span>
<span class="go">03 0 0 4 0</span>
<span class="go">04 0 3 1 0</span>
<span class="go">05 0 4 0 0</span>
<span class="go">XX</span>
</pre></div>
</div>
<p>Finally, if we have internet access, we can create a
<a class="reference external" href="http://weblogo.berkeley.edu">weblogo</a>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">arnt</span><span class="o">.</span><span class="n">weblogo</span><span class="p">(</span><span class="s">&quot;Arnt.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We should get our logo saved as a png in the specified file.</p>
</div>
</div>
<div class="section" id="id3">
<h3>14.9.2  Searching for instances<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>The most frequent use for a motif is to find its instances in some
sequence. For the sake of this section, we will use an artificial
sequence like this:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">test_seq</span><span class="o">=</span><span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TATGATGTAGTATAATATAATTATAA&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
</pre></div>
</div>
<p>The simplest way to find instances, is to look for exact matches of the
true instances of the motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pos</span><span class="p">,</span><span class="n">seq</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">search_instances</span><span class="p">(</span><span class="n">test_seq</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">pos</span><span class="p">,</span><span class="n">seq</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span>
<span class="gp">...</span>
<span class="go">10 TATAA</span>
<span class="go">15 TATAA</span>
<span class="go">21 TATAA</span>
</pre></div>
</div>
<p>We can do the same with the reverse complement (to find instances on the
complementary strand):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pos</span><span class="p">,</span><span class="n">seq</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">()</span><span class="o">.</span><span class="n">search_instances</span><span class="p">(</span><span class="n">test_seq</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">pos</span><span class="p">,</span><span class="n">seq</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span>
<span class="gp">...</span>
<span class="go">12 TAATA</span>
<span class="go">20 TTATA</span>
</pre></div>
</div>
<p>It’s just as easy to look for positions, giving rise to high log-odds
scores against our motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pos</span><span class="p">,</span><span class="n">score</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">search_pwm</span><span class="p">(</span><span class="n">test_seq</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">pos</span><span class="p">,</span><span class="n">score</span>
<span class="gp">...</span>
<span class="go">10 8.44065060871</span>
<span class="go">-12 7.06213898545</span>
<span class="go">15 8.44065060871</span>
<span class="go">-20 8.44065060871</span>
<span class="go">21 8.44065060871</span>
</pre></div>
</div>
<p>You may notice the threshold parameter, here set arbitrarily to 5.0.
This is in <em>log</em><sub>2</sub>, so we are now looking only for words, which
are 32 times more likely to occur under the motif model than in the
background. The default threshold is 0.0, which selects everything that
looks more like the motif than the background.</p>
<p>If you want to use a less arbitrary way of selecting thresholds, you can
explore the <tt class="docutils literal"><span class="pre">Motif.score_distribution</span></tt> class implementing an
distribution of scores for a given motif. Since the space for a score
distribution grows exponentially with motif length, we are using an
approximation with a given precision to keep computation cost
manageable:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span> <span class="o">=</span> <span class="n">Motif</span><span class="o">.</span><span class="n">score_distribution</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">precision</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The sd object can be used to determine a number of different thresholds.</p>
<p>We can specify the requested false-positive rate (probability of
“finding” a motif instance in background generated sequence):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">threshold_fpr</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="go">4.3535838726139886</span>
</pre></div>
</div>
<p>or the false-negative rate (probability of “not finding” an instance
generated from the motif):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">threshold_fnr</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">0.26651713652234044</span>
</pre></div>
</div>
<p>or a threshold (approximately) satisfying some relation between fpr and
fnr <em>fnr</em>/<em>fpr</em>≃ <em>t</em>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">threshold_balanced</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">8.4406506087056368</span>
</pre></div>
</div>
<p>or a threshold satisfying (roughly) the equality between the
false-positive rate and the −<em>log</em> of the information content (as used
in patser software by Hertz and Stormo).</p>
<p>For example, in case of our motif, you can get the threshold giving you
exactly the same results (for this sequence) as searching for instances
with balanced threshold with rate of 1000.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pos</span><span class="p">,</span><span class="n">score</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">search_pwm</span><span class="p">(</span><span class="n">test_seq</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="n">sd</span><span class="o">.</span><span class="n">threshold_balanced</span><span class="p">(</span><span class="mi">1000</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">pos</span><span class="p">,</span><span class="n">score</span>
<span class="gp">...</span>
<span class="go">10 8.44065060871</span>
<span class="go">15 8.44065060871</span>
<span class="go">-20 8.44065060871</span>
<span class="go">21 8.44065060871</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>14.9.3  Comparing motifs<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Once we have more than one motif, we might want to compare them. For
that, we have currently three different methods of <tt class="docutils literal"><span class="pre">Bio.Motif</span></tt>
objects.</p>
<p>Before we start comparing motifs, I should point out that motif
boundaries are usually quite arbitrary. This means, that we often need
to compare motifs of different lengths, so comparison needs to involve
some kind of alignment. This means, that we have to take into account
two things:</p>
<ul class="simple">
<li>alignment of motifs</li>
<li>some function to compare aligned motifs</li>
</ul>
<p>In <tt class="docutils literal"><span class="pre">Bio.Motif</span></tt> we have 3 different functions for motif comparison,
which are based on the same idea behind motif alignment, but use
different functions to compare aligned motifs. Briefly speaking, we are
using ungapped alignment of PWMs and substitute the missing columns at
the beginning and end of the matrices with background distribution. All
three comparison functions are written in such a way, that they can be
interpreted as distance measures, however only one (<tt class="docutils literal"><span class="pre">dist_dpq</span></tt>)
satisfies the triangle inequality. All of them return the minimal
distance and the corresponding offset between motifs.</p>
<p>To show how these functions work, let us first load another motif, which
is similar to our test motif <tt class="docutils literal"><span class="pre">m</span></tt>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ubx</span><span class="o">=</span><span class="n">Motif</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;Ubx.pfm&quot;</span><span class="p">),</span><span class="s">&quot;jaspar-pfm&quot;</span><span class="p">)</span>
<span class="go">&lt;Bio.Motif.Motif.Motif object at 0xc29b90&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ubx</span><span class="o">.</span><span class="n">consensus</span><span class="p">()</span>
<span class="go">Seq(&#39;TAAT&#39;, IUPACUnambiguousDNA())</span>
</pre></div>
</div>
<p>The first function we’ll use to compare these motifs is based on Pearson
correlation. Since we want it to resemble a distance measure, we
actually take 1−<em>r</em>, where <em>r</em> is the Pearson correlation coefficient
(PCC):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">dist_pearson</span><span class="p">(</span><span class="n">ubx</span><span class="p">)</span>
<span class="go">(0.41740393308237722, 2)</span>
</pre></div>
</div>
<p>This means, that the best PCC between motif <tt class="docutils literal"><span class="pre">m</span></tt> and <tt class="docutils literal"><span class="pre">Ubx</span></tt> is
obtained with the following alignment:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">bbTAAT</span>
<span class="n">TATAAb</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">b</span></tt> stands for background distribution. The PCC itself is
roughly 1−0.42=0.58. If we try the reverse complement of the Ubx motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">dist_pearson</span><span class="p">(</span><span class="n">ubx</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">())</span>
<span class="go">(0.25784180151584823, 1)</span>
</pre></div>
</div>
<p>We can see that the PCC is better (almost 0.75), and the alignment is
also different:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">bATTA</span>
<span class="n">TATAA</span>
</pre></div>
</div>
<p>There are two other functions: <tt class="docutils literal"><span class="pre">dist_dpq</span></tt>, which is a true metric
(satisfying traingle inequality) based on the Kullback-Leibler
divergence</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">dist_dpq</span><span class="p">(</span><span class="n">ubx</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">())</span>
<span class="go">(0.49292358382899853, 1)</span>
</pre></div>
</div>
<p>and the <tt class="docutils literal"><span class="pre">dist_product</span></tt> method, which is based on the product of
probabilities which can be interpreted as the probability of
independently generating the same instance by both motifs.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">dist_product</span><span class="p">(</span><span class="n">ubx</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">())</span>
<span class="go">(0.16224587301064275, 1)</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>14.9.4  <em>De novo</em> motif finding<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Currently, Biopython has only limited support for <em>de novo</em> motif
finding. Namely, we support running and parsing of AlignAce and MEME.
Since the number of motif finding tools is growing rapidly,
contributions of new parsers are welcome.</p>
<div class="section" id="id6">
<h4>14.9.4.1  MEME<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Let’s assume, you have run MEME on sequences of your choice with your
favorite parameters and saved the output in the file <tt class="docutils literal"><span class="pre">meme.out</span></tt>. You
can retrieve the motifs reported by MEME by running the following piece
of code:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Motif</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;meme.out&quot;</span><span class="p">),</span><span class="s">&quot;MEME&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span>
<span class="go">[&lt;Bio.Motif.MEMEMotif.MEMEMotif object at 0xc356b0&gt;]</span>
</pre></div>
</div>
<p>Besides the most wanted list of motifs, the result object contains more
useful information, accessible through properties with self-explanatory
names:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">.alphabet</span></tt></li>
<li><tt class="docutils literal"><span class="pre">.datafile</span></tt></li>
<li><tt class="docutils literal"><span class="pre">.sequence_names</span></tt></li>
<li><tt class="docutils literal"><span class="pre">.version</span></tt></li>
<li><tt class="docutils literal"><span class="pre">.command</span></tt></li>
</ul>
<p>The motifs returned by MEMEParser can be treated exactly like regular
Motif objects (with instances), they also provide some extra
functionality, by adding additional information about the instances.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">consensus</span><span class="p">()</span>
<span class="go">Seq(&#39;CTCAATCGTA&#39;, IUPACUnambiguousDNA())</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pvalue</span>
<span class="go">8.71e-07</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sequence_name</span>
<span class="go">&#39;SEQ10;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strand</span>
<span class="go">&#39;+&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h4>14.9.4.2  AlignAce<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>We can do very similar things with AlignACE program. Assume, you have
your output in the file <tt class="docutils literal"><span class="pre">alignace.out</span></tt>. You can parse your output with
the following code:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsA</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">Motif</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;alignace.out&quot;</span><span class="p">),</span><span class="s">&quot;AlignAce&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Again, your motifs behave as they should:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">consensus</span><span class="p">()</span>
<span class="go">Seq(&#39;TCTACGATTGAG&#39;, IUPACUnambiguousDNA())</span>
</pre></div>
</div>
<p>In fact you can even see, that AlignAce found a very similar motif as
MEME, it is just a longer version of a reverse complement of MEME motif:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">motifsM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">()</span><span class="o">.</span><span class="n">consensus</span><span class="p">()</span>
<span class="go">Seq(&#39;TACGATTGAG&#39;, IUPACUnambiguousDNA())</span>
</pre></div>
</div>
<p>If you have AlignAce installed on the same machine, you can also run it
directly from Biopython. Short example of how this can be done is shown
below (other parameters can be specified as keyword parameters):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">command</span><span class="o">=</span><span class="s">&quot;/opt/bin/AlignACE&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="s">&quot;test.fa&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.Motif.Applications</span> <span class="kn">import</span> <span class="n">AlignAceCommandline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmd</span> <span class="o">=</span> <span class="n">AlignAceCommandline</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">command</span><span class="p">,</span><span class="nb">input</span><span class="o">=</span><span class="n">input_file</span><span class="p">,</span><span class="n">gcback</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">numcols</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stdout</span><span class="p">,</span><span class="n">stderr</span><span class="o">=</span> <span class="n">cmd</span><span class="p">()</span>
</pre></div>
</div>
<p>Since AlignAce prints all its output to standard output, you can get to
your motifs by parsing the first part of the result:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">motifs</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">Motif</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="s">&quot;AlignAce&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Chapter 14  Sequence motif analysis using Bio.motifs</a><ul>
<li><a class="reference internal" href="#motif-objects">14.1  Motif objects</a><ul>
<li><a class="reference internal" href="#creating-a-motif-from-instances">14.1.1  Creating a motif from instances</a></li>
<li><a class="reference internal" href="#reading-motifs">14.1.2  Reading motifs</a><ul>
<li><a class="reference internal" href="#jaspar">JASPAR</a></li>
<li><a class="reference internal" href="#meme">MEME</a></li>
<li><a class="reference internal" href="#mast">MAST</a></li>
<li><a class="reference internal" href="#transfac">TRANSFAC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-motifs">14.1.3  Writing motifs</a></li>
<li><a class="reference internal" href="#creating-a-sequence-logo">14.1.4  Creating a sequence logo</a></li>
</ul>
</li>
<li><a class="reference internal" href="#position-weight-matrices">14.2  Position-Weight Matrices</a></li>
<li><a class="reference internal" href="#position-specific-scoring-matrices">14.3  Position-Specific Scoring Matrices</a></li>
<li><a class="reference internal" href="#searching-for-instances">14.4  Searching for instances</a><ul>
<li><a class="reference internal" href="#searching-for-exact-matches">14.4.1  Searching for exact matches</a></li>
<li><a class="reference internal" href="#searching-for-matches-using-the-pssm-score">14.4.2  Searching for matches using the PSSM score</a></li>
<li><a class="reference internal" href="#selecting-a-score-threshold">14.4.3  Selecting a score threshold</a></li>
</ul>
</li>
<li><a class="reference internal" href="#each-motif-object-has-an-associated-position-specific-scoring-matrix">14.5  Each motif object has an associated Position-Specific Scoring Matrix</a></li>
<li><a class="reference internal" href="#comparing-motifs">14.6  Comparing motifs</a></li>
<li><a class="reference internal" href="#de-novo-motif-finding">14.7  <em>De novo</em> motif finding</a><ul>
<li><a class="reference internal" href="#id1">14.7.1  MEME</a></li>
<li><a class="reference internal" href="#alignace">14.7.2  AlignAce</a></li>
</ul>
</li>
<li><a class="reference internal" href="#useful-links">14.8  Useful links</a></li>
<li><a class="reference internal" href="#obsolete-bio-motif-module">14.9  Obsolete Bio.Motif module</a><ul>
<li><a class="reference internal" href="#id2">14.9.1  Motif objects</a><ul>
<li><a class="reference internal" href="#reading-and-writing">14.9.1.1  Reading and writing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3">14.9.2  Searching for instances</a></li>
<li><a class="reference internal" href="#id4">14.9.3  Comparing motifs</a></li>
<li><a class="reference internal" href="#id5">14.9.4  <em>De novo</em> motif finding</a><ul>
<li><a class="reference internal" href="#id6">14.9.4.1  MEME</a></li>
<li><a class="reference internal" href="#id7">14.9.4.2  AlignAce</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="chr13.html"
                        title="previous chapter">Chapter 13  Phylogenetics with Bio.Phylo</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="chr15.html"
                        title="next chapter">Chapter 15  Cluster analysis</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/chr14.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="chr15.html" title="Chapter 15 Cluster analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="chr13.html" title="Chapter 13 Phylogenetics with Bio.Phylo"
             >previous</a> |</li>
        <li><a href="index.html">biopython_en 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, biopythoners.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>