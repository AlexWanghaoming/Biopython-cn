<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>第10章 Swiss-Prot和ExPASy &mdash; biopython_cn 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="biopython_cn 0.1 documentation" href="index.html" />
    <link rel="next" title="第11章 走向3D：PDB模块" href="chr11.html" />
    <link rel="prev" title="第9章 访问NCBI Entrez数据库" href="chr09.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="chr11.html" title="第11章 走向3D：PDB模块"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="chr09.html" title="第9章 访问NCBI Entrez数据库"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">biopython_cn 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="swiss-protexpasy">
<span id="chapter-swiss-prot"></span><h1>第10章 Swiss-Prot和ExPASy<a class="headerlink" href="#swiss-protexpasy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="swiss-prot">
<h2>10.1  解析Swiss-Prot文件<a class="headerlink" href="#swiss-prot" title="Permalink to this headline">¶</a></h2>
<p>Swiss-Prot
( <a class="reference external" href="http://www.expasy.org/sprot">http://www.expasy.org/sprot</a> )是一个
蛋白质序列数据库。 Biopython能够解析纯文本的Swiss-Prot文件,
这种格式也被Swiss-Prot、TrEMBL和PIRPSD的UniProt数据库使用。然而我们并
不支持UniProKB的XML格式文件。</p>
<div class="section" id="id1">
<h3>10.1.1  解析 Swiss-Prot 记录<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>在 <a class="reference internal" href="chr05.html#sec-seqio-expasy-and-swissprot"><em>5.3.2</em></a> 章节中, 我们描述过怎样将一个
Swiss-Prot记录中的序列提出来作为一个 <tt class="docutils literal"><span class="pre">SeqRecord</span></tt> 对象。 此外，你可以将
Swiss-Prot记录存到  <tt class="docutils literal"><span class="pre">Bio.SwissProt.Record</span></tt> 对象, 这实际上存储了Swiss-Prot记录
中所包含的的全部信息。在这部分我们将介绍怎样从一个Swiss-Prot文件中提
取 <tt class="docutils literal"><span class="pre">Bio.SwissProt.Record</span></tt> 对象。</p>
<p>为了解析Swiss-Prot记录，我们首先需要得到一个Swiss-Prot记录文件。根据该Swiss-Prot
记录的储存位置和储存方式，获取该记录文件的方式也有所不同：</p>
<ul>
<li><p class="first">本地打开Swiss-Prot文件：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;myswissprotfile.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">打开使用gzip压缩的Swiss-Prot文件：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">gzip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;myswissprotfile.dat.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">在线打开Swiss-Prot文件：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">urllib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://www.somelocation.org/data/someswissprotfile.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">从ExPASy数据库在线打开Swiss-Prot文件
(见 <a class="reference internal" href="#sec-expasy-swissprot"><em>10.5.1</em></a> 章节):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">ExPASy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">ExPASy</span><span class="o">.</span><span class="n">get_sprot_raw</span><span class="p">(</span><span class="n">myaccessionnumber</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>对于解析来说，关键点在于Swiss-Prot格式的数据，而不是获取它的方式。</p>
<p>我们可以用 <a class="reference internal" href="chr05.html#sec-seqio-expasy-and-swissprot"><em>5.3.2</em></a> 章节中描述的方式，
通过 <tt class="docutils literal"><span class="pre">Bio.SeqIO</span></tt> 来获取格式未知的 <tt class="docutils literal"><span class="pre">SeqRecord</span></tt> 对象。此外，我们也可以
用 <tt class="docutils literal"><span class="pre">Bio.SwissProt</span></tt> 来获取更加匹配基本文件格式的 <tt class="docutils literal"><span class="pre">Bio.SwissProt.Record</span></tt> 对象。</p>
<p>我们使用 <tt class="docutils literal"><span class="pre">read()</span></tt> 函数来从文件中读取一个Swiss-Prot记录：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SwissProt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">SwissProt</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
</pre></div>
</div>
<p>该函数只适用于仅存储了一个Swiss-Prot记录的文件，而当文件中没有或存在
多个记录时使用该函数，会出现 <tt class="docutils literal"><span class="pre">ValueError</span></tt> 提示。</p>
<p>现在我们可以输出一些与这些记录相关的信息：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">record</span><span class="o">.</span><span class="n">description</span>
<span class="go">&#39;RecName: Full=Chalcone synthase 3; EC=2.3.1.74; AltName: Full=Naringenin-chalcone synthase 3;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">record</span><span class="o">.</span><span class="n">references</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&quot;authors:&quot;</span><span class="p">,</span> <span class="n">ref</span><span class="o">.</span><span class="n">authors</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&quot;title:&quot;</span><span class="p">,</span> <span class="n">ref</span><span class="o">.</span><span class="n">title</span>
<span class="gp">...</span>
<span class="go">authors: Liew C.F., Lim S.H., Loh C.S., Goh C.J.;</span>
<span class="go">title: &quot;Molecular cloning and sequence analysis of chalcone synthase cDNAs of</span>
<span class="go">Bromheadia finlaysoniana.&quot;;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">record</span><span class="o">.</span><span class="n">organism_classification</span>
<span class="go">[&#39;Eukaryota&#39;, &#39;Viridiplantae&#39;, &#39;Streptophyta&#39;, &#39;Embryophyta&#39;, ..., &#39;Bromheadia&#39;]</span>
</pre></div>
</div>
<p>为了解析包含多个Swiss-Prot记录的文件，我们使用 <tt class="docutils literal"><span class="pre">parse</span></tt> 函数。这个函数能够让我们对
文件中的记录进行循环迭代操作。</p>
<p>比如，我们要解析整个Swiss-Prot数据库并且收集所有的描述。你可以从
<a class="reference external" href="ftp://ftp.expasy.org/databases/uniprot/current_release/knowledgebase/complete/uniprot_sprot.dat.gz">ExPAYs FTP site</a>
下载这些gzip压缩文件 <tt class="docutils literal"><span class="pre">uniprot_sprot.dat.gz</span></tt> (大约 300MB)。文件中含有
<tt class="docutils literal"><span class="pre">uniprot_sprot.dat</span></tt> 一个文件(至少1.5GB)。</p>
<p>如同这一部分刚开始所描述的，你可以按照如下所示的方法使用python
的 <tt class="docutils literal"><span class="pre">gzip</span></tt> 模块打开并解压 <tt class="docutils literal"><span class="pre">.gz</span></tt> 文件:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">gzip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;uniprot_sprot.dat.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>然而，解压一个大文件比较耗时，而且每次用这种方式打开一个
文件都是比较慢的。所以，如果你有空闲的硬盘空间并且在
最开始就在硬盘里通过解压到来得到 <tt class="docutils literal"><span class="pre">uniprot_sprot.dat</span></tt> ，这样能够在以后就可以像平常那样来打开文件：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;uniprot_sprot.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>到2009年6月为止，从ExPASy下载下来的整个Swiss-Prot数据库一共
有468851个Swiss-Prot记录，一种建立关于这些记录的描述列表的
间接方式就是使用一种列表解析：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SwissProt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;uniprot_sprot.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">descriptions</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">description</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SwissProt</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">descriptions</span><span class="p">)</span>
<span class="go">468851</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">descriptions</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">[&#39;RecName: Full=Protein MGF 100-1R;&#39;,</span>
<span class="go"> &#39;RecName: Full=Protein MGF 100-1R;&#39;,</span>
<span class="go"> &#39;RecName: Full=Protein MGF 100-1R;&#39;,</span>
<span class="go"> &#39;RecName: Full=Protein MGF 100-1R;&#39;,</span>
<span class="go"> &#39;RecName: Full=Protein MGF 100-2L;&#39;]</span>
</pre></div>
</div>
<p>或者对记录迭代器使用for循环：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SwissProt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">descriptions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;uniprot_sprot.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SwissProt</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">descriptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">descriptions</span><span class="p">)</span>
<span class="go">468851</span>
</pre></div>
</div>
<p>由于输入文件太大，这两种方法在我的新台式机上花费大约十一分钟（用解压好的
<tt class="docutils literal"><span class="pre">uniprot_sprot.dat</span></tt> 作为输入文件）。</p>
<p>从Swiss-Prot记录中提取任何你想要的信息也同样简单。比如你想看看一个
Swiss-Prot记录中的成员，就输入：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="go">[&#39;__ doc__ &#39;, &#39;__ init__ &#39;, &#39;__ module__ &#39;, &#39;accessions&#39;, &#39;annotation_update&#39;,</span>
<span class="go">&#39;comments&#39;, &#39;created&#39;, &#39;cross_references&#39;, &#39;data_class&#39;, &#39;description&#39;,</span>
<span class="go">&#39;entry_name&#39;, &#39;features&#39;, &#39;gene_name&#39;, &#39;host_organism&#39;, &#39;keywords&#39;,</span>
<span class="go">&#39;molecule_type&#39;, &#39;organelle&#39;, &#39;organism&#39;, &#39;organism_classification&#39;,</span>
<span class="go">&#39;references&#39;, &#39;seqinfo&#39;, &#39;sequence&#39;, &#39;sequence_length&#39;,</span>
<span class="go">&#39;sequence_update&#39;, &#39;taxonomy_id&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>10.1.2  解析Swiss-Prot关键词和分类列表<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Swiss-Prot也会提供一个 <tt class="docutils literal"><span class="pre">keywlist.txt</span></tt> 文件，该文件列出了Swiss-Prot中所用到
的关键词和分类。其中所包含的词条形式如下：</p>
<div class="code python highlight-python"><pre>ID   2Fe-2S.
AC   KW-0001
DE   Protein which contains at least one 2Fe-2S iron-sulfur cluster: 2 iron
DE   atoms complexed to 2 inorganic sulfides and 4 sulfur atoms of
DE   cysteines from the protein.
SY   Fe2S2; [2Fe-2S] cluster; [Fe2S2] cluster; Fe2/S2 (inorganic) cluster;
SY   Di-mu-sulfido-diiron; 2 iron, 2 sulfur cluster binding.
GO   GO:0051537; 2 iron, 2 sulfur cluster binding
HI   Ligand: Iron; Iron-sulfur; 2Fe-2S.
HI   Ligand: Metal-binding; 2Fe-2S.
CA   Ligand.
//
ID   3D-structure.
AC   KW-0002
DE   Protein, or part of a protein, whose three-dimensional structure has
DE   been resolved experimentally (for example by X-ray crystallography or
DE   NMR spectroscopy) and whose coordinates are available in the PDB
DE   database. Can also be used for theoretical models.
HI   Technical term: 3D-structure.
CA   Technical term.
//
ID   3Fe-4S.
...</pre>
</div>
<p>文件中的词条可以通过使用 <tt class="docutils literal"><span class="pre">Bio.SwissProt.KeyWList</span></tt> 模块中的 <tt class="docutils literal"><span class="pre">parse</span></tt> 函数
来解析，并且每一个词条都会被存储在名为 <tt class="docutils literal"><span class="pre">Bio.SwissProt.KeyWList.Record</span></tt> 的
python字典里。</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.SwissProt</span> <span class="kn">import</span> <span class="n">KeyWList</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;keywlist.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">records</span> <span class="o">=</span> <span class="n">KeyWList</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">record</span><span class="p">[</span><span class="s">&#39;ID&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">record</span><span class="p">[</span><span class="s">&#39;DE&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>这些命令行将会输出：</p>
<div class="code python highlight-python"><pre>2Fe-2S.
Protein which contains at least one 2Fe-2S iron-sulfur cluster: 2 iron atoms
complexed to 2 inorganic sulfides and 4 sulfur atoms of cysteines from the
protein.
...</pre>
</div>
</div>
</div>
<div class="section" id="prosite">
<h2>10.2  解析Prosite记录<a class="headerlink" href="#prosite" title="Permalink to this headline">¶</a></h2>
<p>Prosite是一个包含了蛋白质结构域、蛋白家族、功能位点以及识别它们的模式和图
谱，而且它是和Swiss-Prot同时开发出来的。
在Biopython中，Prosite记录是由 <tt class="docutils literal"><span class="pre">Bio.ExPASy.Prosite.Record</span></tt> 类来表示的，
其中的成员与该Prosite记录中的不同区域相对应。</p>
<p>一般来说，一个Prosite文件可以包含多个Prosite记录。比如，从 <a class="reference external" href="ftp://ftp.expasy.org/databases/prosite/prosite.dat">ExPASy FTP
site</a> 网站下载
下来的、容纳了整个Prosite记录的 <tt class="docutils literal"><span class="pre">prosite.dat</span></tt> 文件，含有2073条记录（2007年12月发布的第20.24版本）。
为了解析这样一个文件，我们再次使用一个迭代器：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.ExPASy</span> <span class="kn">import</span> <span class="n">Prosite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;myprositefile.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">records</span> <span class="o">=</span> <span class="n">Prosite</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
</pre></div>
</div>
<p>现在我们可以逐个提取这些记录并输出其中一些信息。比如，使用包含整个Prosite数据库的
文件将会使我们找到如下等信息：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.ExPASy</span> <span class="kn">import</span> <span class="n">Prosite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;prosite.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">records</span> <span class="o">=</span> <span class="n">Prosite</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">records</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">accession</span>
<span class="go">&#39;PS00001&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;ASN_GLYCOSYLATION&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">pdoc</span>
<span class="go">&#39;PDOC00001&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">records</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">accession</span>
<span class="go">&#39;PS00004&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;CAMP_PHOSPHO_SITE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">pdoc</span>
<span class="go">&#39;PDOC00004&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">records</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">accession</span>
<span class="go">&#39;PS00005&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;PKC_PHOSPHO_SITE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="o">.</span><span class="n">pdoc</span>
<span class="go">&#39;PDOC00005&#39;</span>
</pre></div>
</div>
<p>如果你想知道有多少条Prosite记录，你可以输入：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.ExPASy</span> <span class="kn">import</span> <span class="n">Prosite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;prosite.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">records</span> <span class="o">=</span> <span class="n">Prosite</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span> <span class="n">n</span><span class="o">+=</span><span class="mi">1</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">n</span>
<span class="go">2073</span>
</pre></div>
</div>
<p>为了从这些数据中读取某一条特定的记录，可以使用 <tt class="docutils literal"><span class="pre">read</span></tt> 函数：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.ExPASy</span> <span class="kn">import</span> <span class="n">Prosite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;mysingleprositerecord.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">Prosite</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
</pre></div>
</div>
<p>如果并不存在或存在多个你想要找的Prosite记录时，这个函数将会输出一个“ValueError”提示。</p>
</div>
<div class="section" id="id3">
<h2>10.3  解析Prosite文件记录<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>在上述的Prosite示例中，像 <tt class="docutils literal"><span class="pre">'PDOC00001'</span></tt> 、 <tt class="docutils literal"><span class="pre">'PDOC00004'</span></tt> 、 <tt class="docutils literal"><span class="pre">'PDOC00005'</span></tt> 等这样的编号指的就
是Prosite文件。Prosite文件记录可以以单个文件（ <tt class="docutils literal"><span class="pre">prosite.doc</span></tt> ）的形式从ExPASy获取，并
且该文件包含了所有Prosite文档记录。</p>
<p>我们使用 <tt class="docutils literal"><span class="pre">Bio.ExPASy.Prodoc</span></tt> 中的解析器来解析这些Prosite文档记录。比如，为了生成一个包含所有
Prosite文档记录的编号列表，你可以使用：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.ExPASy</span> <span class="kn">import</span> <span class="n">Prodoc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;prosite.doc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">records</span> <span class="o">=</span> <span class="n">Prodoc</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">accessions</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">accession</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span>
</pre></div>
</div>
<p>进一步可以使用 <tt class="docutils literal"><span class="pre">read()</span></tt> 函数来对这些数据中具体某一条文档记录来进行查询。</p>
</div>
<div class="section" id="id4">
<h2>10.4  解析酶记录<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>ExPASy的酶数据库是一个关于酶的系统命名信息的数据库。如下所示是一个比较典型的酶的记录</p>
<div class="code python highlight-python"><pre>ID   3.1.1.34
DE   Lipoprotein lipase.
AN   Clearing factor lipase.
AN   Diacylglycerol lipase.
AN   Diglyceride lipase.
CA   Triacylglycerol + H(2)O = diacylglycerol + a carboxylate.
CC   -!- Hydrolyzes triacylglycerols in chylomicrons and very low-density
CC       lipoproteins (VLDL).
CC   -!- Also hydrolyzes diacylglycerol.
PR   PROSITE; PDOC00110;
DR   P11151, LIPL_BOVIN ;  P11153, LIPL_CAVPO ;  P11602, LIPL_CHICK ;
DR   P55031, LIPL_FELCA ;  P06858, LIPL_HUMAN ;  P11152, LIPL_MOUSE ;
DR   O46647, LIPL_MUSVI ;  P49060, LIPL_PAPAN ;  P49923, LIPL_PIG   ;
DR   Q06000, LIPL_RAT   ;  Q29524, LIPL_SHEEP ;
//</pre>
</div>
<p>在这个例子中，第一行显示了脂蛋白脂肪酶（第二行）的酶编号(EC, Enzyme Commission)。
脂蛋白脂肪酶其他的名称有“清除因子脂肪酶”和“甘油二脂脂肪酶”（第三行至第五行）。
开头为“CA”的那一行显示了该酶的催化活性。评论行开头为“CC”。“PR”行显示了对应Prosite
文档记录的参考，以及“DR”行显示了Swiss-Prot记录的参考。
然而并不是所有的词条都必需出现在酶记录当中。</p>
<p>在Biopython中，一个酶记录由 <tt class="docutils literal"><span class="pre">Bio.ExPASy.Enzyme.Record</span></tt> 类来代表。这个记录源于对应
于酶相关文件中所用到的双字母编码的python字典和哈希键。为了阅读含有一个酶记录的酶文件，
你可以使用 <tt class="docutils literal"><span class="pre">Bio.ExPASy.Enzyme</span></tt> 中的 <tt class="docutils literal"><span class="pre">read</span></tt> 函数：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.ExPASy</span> <span class="kn">import</span> <span class="n">Enzyme</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;lipoprotein.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">Enzyme</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="p">[</span><span class="s">&quot;ID&quot;</span><span class="p">]</span>
<span class="go">&#39;3.1.1.34&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="p">[</span><span class="s">&quot;DE&quot;</span><span class="p">]</span>
<span class="go">&#39;Lipoprotein lipase.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="p">[</span><span class="s">&quot;AN&quot;</span><span class="p">]</span>
<span class="go">[&#39;Clearing factor lipase.&#39;, &#39;Diacylglycerol lipase.&#39;, &#39;Diglyceride lipase.&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="p">[</span><span class="s">&quot;CA&quot;</span><span class="p">]</span>
<span class="go">&#39;Triacylglycerol + H(2)O = diacylglycerol + a carboxylate.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="p">[</span><span class="s">&quot;PR&quot;</span><span class="p">]</span>
<span class="go">[&#39;PDOC00110&#39;]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="p">[</span><span class="s">&quot;CC&quot;</span><span class="p">]</span>
<span class="go">[&#39;Hydrolyzes triacylglycerols in chylomicrons and very low-density lipoproteins</span>
<span class="go">(VLDL).&#39;, &#39;Also hydrolyzes diacylglycerol.&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span><span class="p">[</span><span class="s">&quot;DR&quot;</span><span class="p">]</span>
<span class="go">[[&#39;P11151&#39;, &#39;LIPL_BOVIN&#39;], [&#39;P11153&#39;, &#39;LIPL_CAVPO&#39;], [&#39;P11602&#39;, &#39;LIPL_CHICK&#39;],</span>
<span class="go">[&#39;P55031&#39;, &#39;LIPL_FELCA&#39;], [&#39;P06858&#39;, &#39;LIPL_HUMAN&#39;], [&#39;P11152&#39;, &#39;LIPL_MOUSE&#39;],</span>
<span class="go">[&#39;O46647&#39;, &#39;LIPL_MUSVI&#39;], [&#39;P49060&#39;, &#39;LIPL_PAPAN&#39;], [&#39;P49923&#39;, &#39;LIPL_PIG&#39;],</span>
<span class="go">[&#39;Q06000&#39;, &#39;LIPL_RAT&#39;], [&#39;Q29524&#39;, &#39;LIPL_SHEEP&#39;]]</span>
</pre></div>
</div>
<p>如果没有找到或者找到多个酶记录时， <tt class="docutils literal"><span class="pre">read</span></tt> 函数会反馈一个ValueError提示。</p>
<p>所有酶记录都可以从 <a class="reference external" href="ftp://ftp.expasy.org/databases/enzyme/enzyme.dat">ExPASy FTP site</a> 网站下载
为单个文件（ <tt class="docutils literal"><span class="pre">enzyme.dat</span></tt> ），该文件包含了4877个记录（2009年3月发布的第三版）。为了打开含有多个
酶记录的文件，你可以使用 <tt class="docutils literal"><span class="pre">Bio.ExPASy.Enzyme</span></tt> 中的 <tt class="docutils literal"><span class="pre">parse</span></tt> 函数来获得一个迭代器：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.ExPASy</span> <span class="kn">import</span> <span class="n">Enzyme</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;enzyme.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">records</span> <span class="o">=</span> <span class="n">Enzyme</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
</pre></div>
</div>
<p>我们现在每次都可以对这些记录进行迭代。比如我们可以对那些已有的酶记录做一个EC编号列表：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ecnumbers</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span><span class="p">[</span><span class="s">&quot;ID&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-the-expasy-server">
<h2>10.5  Accessing the ExPASy server<a class="headerlink" href="#accessing-the-expasy-server" title="Permalink to this headline">¶</a></h2>
<p>Swiss-Prot、Prosite和Prosite文档记录可以从
<a class="reference external" href="http://www.expasy.org">http://www.expasy.org</a> 的ExPASy网络服务器下载到。在ExPASy服
务器上可以进行六种查询：</p>
<dl class="docutils">
<dt><strong>get_prodoc_entry</strong></dt>
<dd>下载一个HTML格式的Prosite文档记录</dd>
<dt><strong>get_prosite_entry</strong></dt>
<dd>下载一个HTML格式的Prosite记录</dd>
<dt><strong>get_prosite_raw</strong></dt>
<dd>下载一个原始格式的Prosite或Prosite文档记录</dd>
<dt><strong>get_sprot_raw</strong></dt>
<dd>下载一个原始格式的Swiss-Prot记录</dd>
<dt><strong>sprot_search_ful</strong></dt>
<dd>搜索一个Swiss-Prot记录</dd>
<dt><strong>sprot_search_de</strong></dt>
<dd>搜索一个Swiss-Prot记录</dd>
</dl>
<p>为了从python脚本来访问该网络服务器，我们可以使用 <tt class="docutils literal"><span class="pre">Bio.ExPASy</span></tt> 模块。</p>
<div class="section" id="sec-expasy-swissprot">
<span id="id5"></span><h3>10.5.1  获取一个Swiss-Prot记录<a class="headerlink" href="#sec-expasy-swissprot" title="Permalink to this headline">¶</a></h3>
<p>现在让我们来寻找一个关于兰花的查儿酮合成酶（对于寻找和兰花相关的有趣东西的理由
请看 <a class="reference internal" href="chr02.html#sec-orchids"><em>2.3</em></a> 章节）。查儿酮合成酶参与了植物中类黄酮的生物合成，
类黄酮能够合成包含色素和UV保护分子等物质。</p>
<p>如果你要对Swiss-Prot进行搜索，你可以找到三个关于查儿酮合成酶的兰花蛋白，id编号
为O23729, O23730, O23731。现在我们要写一个能够获取这些蛋白并能够找到一些有趣
的信息的脚本。</p>
<p>首先，我们使用 <tt class="docutils literal"><span class="pre">Bio.ExPASy</span></tt> 中的 <tt class="docutils literal"><span class="pre">get_sprot_raw()</span></tt> 函数来获取这些记录。这个函
数非常棒，因为你可以给它提供一个id然后得到一个原始文本记录（不会受到HTML的干扰）。
然后我们可以使用 <tt class="docutils literal"><span class="pre">Bio.SwissProt.read</span></tt> 来提取对应的Swiss-Prot记录，也可以使用 <tt class="docutils literal"><span class="pre">Bio.SeqIO.read</span></tt> 来
得到一个序列记录SeqRecord。下列代码能够实现我刚刚提到的任务：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">ExPASy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SwissProt</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">accessions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;O23729&quot;</span><span class="p">,</span> <span class="s">&quot;O23730&quot;</span><span class="p">,</span> <span class="s">&quot;O23731&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">accession</span> <span class="ow">in</span> <span class="n">accessions</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">handle</span> <span class="o">=</span> <span class="n">ExPASy</span><span class="o">.</span><span class="n">get_sprot_raw</span><span class="p">(</span><span class="n">accession</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">record</span> <span class="o">=</span> <span class="n">SwissProt</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</pre></div>
</div>
<p>如果你提供给 <tt class="docutils literal"><span class="pre">ExPASy.get_sprot_raw</span></tt> 的编号并不存在，那么 <tt class="docutils literal"><span class="pre">SwissProt.read(handle)</span></tt> 会反
馈一个 <tt class="docutils literal"><span class="pre">ValueError</span></tt> 提示。你可以根据 <tt class="docutils literal"><span class="pre">ValueException</span></tt> 异常来找到无效的编号：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">accession</span> <span class="ow">in</span> <span class="n">accessions</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">handle</span> <span class="o">=</span> <span class="n">ExPASy</span><span class="o">.</span><span class="n">get_sprot_raw</span><span class="p">(</span><span class="n">accession</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">record</span> <span class="o">=</span> <span class="n">SwissProt</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="n">ValueException</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&quot;WARNING: Accession </span><span class="si">%s</span><span class="s"> not found&quot;</span> <span class="o">%</span> <span class="n">accession</span>
<span class="gp">... </span>    <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>10.5.2  搜索Swiss-Prot<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>现在，你可以察觉到我已经提前知道了这个记录的编号。的确， <tt class="docutils literal"><span class="pre">get_sprot_raw()</span></tt> 需要一个词条或者编号。
当你并没有编号或者词条的时候，你可使用 <tt class="docutils literal"><span class="pre">sprot_search_de()</span></tt> 或者 <tt class="docutils literal"><span class="pre">sprot_search_ful()</span></tt> 函数来解决问题。</p>
<p><tt class="docutils literal"><span class="pre">sprot_search_de()</span></tt> 在ID, DE, GN, OS和OG行进行搜索；
<tt class="docutils literal"><span class="pre">sprot_search_ful()</span></tt> 则在所有行进行搜索。具体相关细节分别在
<a class="reference external" href="http://www.expasy.org/cgi-bin/sprot-search-de">http://www.expasy.org/cgi-bin/sprot-search-de</a>
和
<a class="reference external" href="http://www.expasy.org/cgi-bin/sprot-search-ful">http://www.expasy.org/cgi-bin/sprot-search-ful</a> 上有说明。
注意它们的默认情况下并不搜索TrEMBL（参数为 <tt class="docutils literal"><span class="pre">trembl</span></tt> ）。还要注意它们返回的是html网页，然而编号却可以很容易从中得到：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">ExPASy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">ExPASy</span><span class="o">.</span><span class="n">sprot_search_de</span><span class="p">(</span><span class="s">&quot;Orchid Chalcone Synthase&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># or:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># handle = ExPASy.sprot_search_ful(&quot;Orchid and {Chalcone Synthase}&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">html_results</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="s">&quot;Number of sequences found&quot;</span> <span class="ow">in</span> <span class="n">html_results</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ids</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r&#39;HREF=&quot;/uniprot/(\w+)&quot;&#39;</span><span class="p">,</span> <span class="n">html_results</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ids</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r&#39;href=&quot;/cgi-bin/niceprot\.pl\?(\w+)&quot;&#39;</span><span class="p">,</span> <span class="n">html_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="prositeprosite">
<h3>10.5.3  获取Prosite和Prosite文档记录<a class="headerlink" href="#prositeprosite" title="Permalink to this headline">¶</a></h3>
<p>我们可以得到HTML格式和原始格式的Prosite和Prosite文档记录。为了用biopython解析Prosite和Prosite文档记录，
你应该使用原始格式的记录。而对于其他的目的，你或许会对HTML格式感兴趣。</p>
<p>为了获取一个原始格式的Prosite或者Prosite文档的记录，请使用 <tt class="docutils literal"><span class="pre">get_prosite_raw()</span></tt> 。
例如，为了下载一个prosite记录并以原始格式输出，你可以使用：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">ExPASy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">ExPASy</span><span class="o">.</span><span class="n">get_prosite_raw</span><span class="p">(</span><span class="s">&#39;PS00001&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">text</span>
</pre></div>
</div>
<p>为了获取一个Prosite记录并将其解析成一个 <tt class="docutils literal"><span class="pre">Bio.Prosite.Record</span></tt> 对象，请使用：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">ExPASy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">Prosite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">ExPASy</span><span class="o">.</span><span class="n">get_prosite_raw</span><span class="p">(</span><span class="s">&#39;PS00001&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">Prosite</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
</pre></div>
</div>
<p>该函数也可以用于获取Prosite文档记录并解析到一个 <tt class="docutils literal"><span class="pre">Bio.ExPASy.Prodoc.Record</span></tt> 对象：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">ExPASy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.ExPASy</span> <span class="kn">import</span> <span class="n">Prodoc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">ExPASy</span><span class="o">.</span><span class="n">get_prosite_raw</span><span class="p">(</span><span class="s">&#39;PDOC00001&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">Prodoc</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
</pre></div>
</div>
<p>对于不存在的编号， <tt class="docutils literal"><span class="pre">ExPASy.get_prosite_raw</span></tt> 返回一个空字符串。当遇到空字符
串， <tt class="docutils literal"><span class="pre">Prosite.read</span></tt> 和 <tt class="docutils literal"><span class="pre">Prodoc.read</span></tt> 会反馈一个ValueError错误。你可以
根据这些错误异常提示来找到无效的编号。</p>
<p><tt class="docutils literal"><span class="pre">get_prosite_entry()</span></tt> 和 <tt class="docutils literal"><span class="pre">get_prodoc_entry()</span></tt> 函数可用于下载HTML格式的Prosite和Prosite文档记录。
为了生成展示单个Prosite记录的网页，你可以使用：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">ExPASy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">ExPASy</span><span class="o">.</span><span class="n">get_prosite_entry</span><span class="p">(</span><span class="s">&#39;PS00001&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">html</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;myprositerecord.html&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>类似地，Prosite文档文本的网页展示如下：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">ExPASy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">ExPASy</span><span class="o">.</span><span class="n">get_prodoc_entry</span><span class="p">(</span><span class="s">&#39;PDOC00001&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">html</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;myprodocrecord.html&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>对于这些函数，无效的编号会返回一个HTML格式的错误信息。</p>
</div>
</div>
<div class="section" id="id7">
<h2>10.6  浏览Prosite数据库<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.expasy.org/tools/scanprosite/">ScanProsite</a>  允许你通过向Prosite数据库提供一个
Uniprot或者PDB序列编号或序列来在线浏览蛋白序列。关于ScanProsite更多的信息，请阅
读 <a class="reference external" href="http://www.expasy.org/tools/scanprosite/scanprosite-doc.html">ScanProsite文档</a> 以及
<a class="reference external" href="http://www.expasy.org/tools/scanprosite/ScanPrositeREST.html">程序性访问ScanProsite说明文档</a> 。</p>
<p>你也可以使用Biopython的 <tt class="docutils literal"><span class="pre">Bio.ExPASy.ScanProsite</span></tt> 模块来从python浏览Prosite数据库，这个模块既
能够帮你安全访问ScanProsite，也可以对ScanProsite返回的结果进行解析。为了查看下边序列中
的Prosite模式（pattern）：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">MEHKEVVLLLLLFLKSGQGEPLDDYVNTQGASLFSVTKKQLGAGSIEECAAKCEEDEEFT</span>
<span class="n">CRAFQYHSKEQQCVIMAENRKSSIIIRMRDVVLFEKKVYLSECKTGNGKNYRGTMSKTKN</span>
</pre></div>
</div>
<p>你可以使用下边的代码：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sequence</span> <span class="o">=</span> <span class="s">&quot;MEHKEVVLLLLLFLKSGQGEPLDDYVNTQGASLFSVTKKQLGAGSIEECAAKCEEDEEFT</span>
<span class="go">CRAFQYHSKEQQCVIMAENRKSSIIIRMRDVVLFEKKVYLSECKTGNGKNYRGTMSKTKN&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.ExPASy</span> <span class="kn">import</span> <span class="n">ScanProsite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">ScanProsite</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="n">sequence</span><span class="p">)</span>
</pre></div>
</div>
<p>你可以通过执行 <tt class="docutils literal"><span class="pre">handle.read()</span></tt> 获取原始XML格式的搜索结果。此外，我们可以使用 <tt class="docutils literal"><span class="pre">Bio.ExPASy.ScanProsite.read</span></tt>
来将原始的XML数据解析到一个python对象：</p>
<div class="code python highlight-python"><pre>   &gt;&gt;&gt; result = ScanProsite.read(handle)
   &gt;&gt;&gt; type(result)
   &lt;class 'Bio.ExPASy.ScanProsite.Record'&gt;

``Bio.ExPASy.ScanProsite.Record`` 对象源自一个由ScanProsite返回的包含了ScanProsite hits的列表，这个对象也能够存储hits的数量以及所找到序列的数量。本次ScanProsite搜索找到了6个hits：</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">n_seq</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">n_match</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&#39;signature_ac&#39;: u&#39;PS50948&#39;, &#39;level&#39;: u&#39;0&#39;, &#39;stop&#39;: 98, &#39;sequence_ac&#39;: u&#39;USERSEQ1&#39;, &#39;start&#39;: 16, &#39;score&#39;: u&#39;8.873&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">{&#39;start&#39;: 37, &#39;stop&#39;: 39, &#39;sequence_ac&#39;: u&#39;USERSEQ1&#39;, &#39;signature_ac&#39;: u&#39;PS00005&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">{&#39;start&#39;: 45, &#39;stop&#39;: 48, &#39;sequence_ac&#39;: u&#39;USERSEQ1&#39;, &#39;signature_ac&#39;: u&#39;PS00006&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">{&#39;start&#39;: 60, &#39;stop&#39;: 62, &#39;sequence_ac&#39;: u&#39;USERSEQ1&#39;, &#39;signature_ac&#39;: u&#39;PS00005&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="go">{&#39;start&#39;: 80, &#39;stop&#39;: 83, &#39;sequence_ac&#39;: u&#39;USERSEQ1&#39;, &#39;signature_ac&#39;: u&#39;PS00004&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="go">{&#39;start&#39;: 106, &#39;stop&#39;: 111, &#39;sequence_ac&#39;: u&#39;USERSEQ1&#39;, &#39;signature_ac&#39;: u&#39;PS00008&#39;}</span>
</pre></div>
</div>
<p>其他的ScanProsite参数可以以关键词参数的形式被传递，更多的信息详见 <a class="reference external" href="http://www.expasy.org/tools/scanprosite/ScanPrositeREST.html">程序性访问
ScanProsite说明文档</a> 。
比如，传递 <tt class="docutils literal"><span class="pre">lowscore=1</span></tt> 可以帮我们找到一个新的低分值hit：</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span> <span class="o">=</span> <span class="n">ScanProsite</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">lowscore</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ScanProsite</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">n_match</span>
<span class="go">7</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">第10章 Swiss-Prot和ExPASy</a><ul>
<li><a class="reference internal" href="#swiss-prot">10.1  解析Swiss-Prot文件</a><ul>
<li><a class="reference internal" href="#id1">10.1.1  解析 Swiss-Prot 记录</a></li>
<li><a class="reference internal" href="#id2">10.1.2  解析Swiss-Prot关键词和分类列表</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prosite">10.2  解析Prosite记录</a></li>
<li><a class="reference internal" href="#id3">10.3  解析Prosite文件记录</a></li>
<li><a class="reference internal" href="#id4">10.4  解析酶记录</a></li>
<li><a class="reference internal" href="#accessing-the-expasy-server">10.5  Accessing the ExPASy server</a><ul>
<li><a class="reference internal" href="#sec-expasy-swissprot">10.5.1  获取一个Swiss-Prot记录</a></li>
<li><a class="reference internal" href="#id6">10.5.2  搜索Swiss-Prot</a></li>
<li><a class="reference internal" href="#prositeprosite">10.5.3  获取Prosite和Prosite文档记录</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">10.6  浏览Prosite数据库</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="chr09.html"
                        title="previous chapter">第9章  访问NCBI Entrez数据库</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="chr11.html"
                        title="next chapter">第11章  走向3D：PDB模块</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/chr10.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="chr11.html" title="第11章 走向3D：PDB模块"
             >next</a> |</li>
        <li class="right" >
          <a href="chr09.html" title="第9章 访问NCBI Entrez数据库"
             >previous</a> |</li>
        <li><a href="index.html">biopython_cn 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, biopythoners.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>